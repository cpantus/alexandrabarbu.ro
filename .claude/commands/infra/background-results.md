# Background Results Command

ğŸ“‹ View the output and results from completed or running background agents.

## Purpose

Retrieve and display the report files generated by background agents, whether the agent is still running (partial results) or completed (final results).

## Usage

```bash
/background-results [agent-id]
/background-results [agent-id] --format [md|json|text]
/background-results [agent-id] --output [file-path]
/background-results all
```

## Parameters

### Required
- **agent-id**: Agent ID to retrieve results from (e.g., `agent-a3f9b2`)
  - Use `all` to see results from all completed agents

### Optional
- `--format [md|json|text]`: Output format (default: md)
  - `md` - Markdown (default, preserves formatting)
  - `json` - Structured JSON data
  - `text` - Plain text (strips formatting)
- `--output [file-path]`: Save results to file instead of displaying
- `--tail [n]`: Show only last N lines (useful for running agents)
- `--watch`: Auto-refresh results every 5 seconds (running agents only)

## Examples

### Basic Usage
```bash
# View completed agent results
/background-results agent-a3f9b2

# View partial results from running agent
/background-results agent-b7e2c1

# View all completed agent results
/background-results all
```

### With Format Options
```bash
# Get structured JSON output
/background-results agent-a3f9b2 --format json

# Get plain text (no markdown)
/background-results agent-a3f9b2 --format text
```

### Save to File
```bash
# Save results to file
/background-results agent-a3f9b2 --output reports/q4-analysis.md

# Save JSON to file
/background-results agent-a3f9b2 --format json --output data/analysis.json
```

### Tail Mode (Running Agents)
```bash
# Show last 50 lines (see latest progress)
/background-results agent-b7e2c1 --tail 50

# Watch mode (auto-refresh)
/background-results agent-b7e2c1 --watch
```

## Output Format

### Completed Agent Results

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Agent Results: analyst-Q4-metrics (agent-a3f9b2)      â”‚
â”‚ Status: completed âœ“                                     â”‚
â”‚ Completed: 2025-11-04 14:45:23 (15m 8s runtime)       â”‚
â”‚ Cost: $0.43                                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

# Q4 Marketing Metrics Analysis

## Executive Summary

Analysis of Q4 2024 marketing performance reveals three critical insights:

1. **Funnel Drop-off at Demo Stage** (38% drop)
   - Strategic Sarah persona shows 45% drop-off rate
   - Primary cause: Complex demo signup flow (7 fields)
   - Recommendation: Implement 1-click demo booking

2. **Email Campaign Performance Decline** (-23% CTR)
   - Q4 CTR: 3.2% (down from Q3: 4.2%)
   - Root cause: Generic messaging not persona-specific
   - Recommendation: Segment campaigns by persona

3. **Paid Social ROI Improvement** (+156% ROAS)
   - LinkedIn ads outperforming (ROAS: 4.2x)
   - Budget allocation opportunity: +$15K/month
   - Recommendation: Scale LinkedIn, reduce Meta spend

## Detailed Analysis

### Funnel Performance by Persona

| Persona | Traffic | Signup | Demo | Close | Conversion |
|---------|---------|--------|------|-------|------------|
| Strategic Sarah | 2,340 | 1,450 (62%) | 798 (55%) | 287 (36%) | 12.3% |
| Technical Tom | 1,890 | 1,245 (66%) | 923 (74%) | 412 (45%) | 21.8% |
| Budget Beth | 1,560 | 892 (57%) | 445 (50%) | 134 (30%) | 8.6% |

**Key Finding**: Technical Tom has 2x conversion rate of Strategic Sarah
**Action**: Optimize Sarah funnel (highest traffic, lowest conversion)

[... full report continues ...]

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

Report saved to: reports/q4-analysis.md
View full report: cat reports/q4-analysis.md
Agent telemetry: /observe agent-a3f9b2 (Phase 19)
```

### Running Agent Results (Partial)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Agent Results: copywriter-LinkedIn (agent-b7e2c1)     â”‚
â”‚ Status: running ğŸŸ¢ (8m 12s elapsed)                    â”‚
â”‚ Progress: 60% (6/10 variants complete)                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

# LinkedIn Post Variants - Product Launch

## Completed Variants (6/10)

### Variant 1: Problem-Solution Hook
**Target**: Strategic Sarah
**Angle**: Pain point â†’ Solution

"Tired of juggling 5 different marketing tools?

We were too. That's why we built [Product] - the all-in-one marketing platform that cuts tool sprawl by 80%.

Launch campaigns in minutes, not hours.
See results in real-time, not next week.

Join 2,500+ marketing teams already using [Product].

[Try it free] [Watch demo]"

**Metrics Prediction**: CTR 4.2%, Engagement 380/post
**Best for**: Awareness stage, pain-aware audience

---

### Variant 2: Social Proof Hook
**Target**: Budget Beth
**Angle**: Customer success story

[... variants 2-6 shown ...]

## In Progress (4/10)

Currently generating:
- Variant 7: Data-driven hook
- Variant 8: Storytelling hook
- Variant 9: Question hook
- Variant 10: Contrarian hook

[Work in progress - check back in 5 minutes]

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

Partial report: /tmp/agents/agent-b7e2c1-report.md
Watch progress: /background-results agent-b7e2c1 --watch
Check status: /background-status agent-b7e2c1
```

### All Completed Results

```
Background Agent Results (3 completed)
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

agent-a3f9b2 (analyst, Q4 metrics)
  Status: completed âœ“
  Runtime: 15m 8s
  Cost: $0.43
  Output: reports/q4-analysis.md (12,340 chars)
  Summary: Identified 3 critical insights, 8 recommendations

agent-c1d6e8 (scout, email templates)
  Status: completed âœ“
  Runtime: 4m 23s
  Cost: $0.05
  Output: /tmp/agents/agent-c1d6e8-report.md (2,890 chars)
  Summary: Found 47 email template files across 12 directories

agent-f9b3a7 (scout, email components)
  Status: completed âœ“
  Runtime: 3m 51s
  Cost: $0.04
  Output: /tmp/agents/agent-f9b3a7-report.md (1,670 chars)
  Summary: Found 23 reusable components in templates

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

View specific results: /background-results [agent-id]
Cleanup completed agents: /agent-cleanup (Phase 20)
```

## JSON Format Output

When using `--format json`:

```json
{
  "agentId": "agent-a3f9b2",
  "agentType": "analyst",
  "status": "completed",
  "prompt": "Analyze Q4 metrics and identify top 3 insights",
  "runtime": {
    "start": "2025-11-04T14:30:15Z",
    "end": "2025-11-04T14:45:23Z",
    "duration": 908
  },
  "cost": {
    "inputTokens": 62450,
    "outputTokens": 8230,
    "total": 0.434
  },
  "output": {
    "reportFile": "/tmp/agents/agent-a3f9b2-report.md",
    "finalFile": "reports/q4-analysis.md",
    "size": 12340
  },
  "summary": {
    "insights": 3,
    "recommendations": 8,
    "dataPoints": 24
  },
  "results": {
    "format": "markdown",
    "content": "# Q4 Marketing Metrics Analysis\n\n## Executive Summary\n\n..."
  },
  "telemetry": {
    "toolCalls": 14,
    "filesRead": 3,
    "filesWritten": 1,
    "contextUsed": 87234
  }
}
```

## Report File Structure

Background agents write results to report files in stages:

### Stage 1: Initialization
```markdown
# Agent Report: analyst-Q4-metrics
Agent ID: agent-a3f9b2
Started: 2025-11-04 14:30:15
Status: running

## Task
Analyze Q4 metrics and identify top 3 insights

## Setup
- Loading data/q4-metrics.csv
- Loading skills/marketing-analytics.md
- Loading priming/analysis-context.md
```

### Stage 2: Execution (incremental updates)
```markdown
## Phase 1: Data Loading âœ“
- Loaded Q4 metrics: 2,450 rows
- Date range: 2024-10-01 to 2024-12-31
- Metrics: traffic, signups, demos, conversions

## Phase 2: Analysis (in progress)
- Calculating funnel metrics by persona...
- Computing statistical significance...
```

### Stage 3: Results
```markdown
## Analysis Results

### Insight 1: Funnel Drop-off at Demo Stage
[detailed analysis...]

### Insight 2: Email Campaign Performance Decline
[detailed analysis...]

### Insight 3: Paid Social ROI Improvement
[detailed analysis...]
```

### Stage 4: Completion
```markdown
## Summary
- 3 critical insights identified
- 8 actionable recommendations
- 24 data points analyzed
- Statistical significance: p < 0.05 on all findings

## Next Steps
1. Implement 1-click demo booking
2. Segment email campaigns by persona
3. Increase LinkedIn ad budget by $15K/month

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Agent completed: 2025-11-04 14:45:23
Runtime: 15m 8s
Cost: $0.434
```

## Integration with Output Files

When agent spawned with `--output [file]`:
```bash
/background analyst "Analyze Q4 metrics" --output reports/q4-analysis.md
```

Results are written to BOTH:
1. **Report file** (temp): `/tmp/agents/agent-a3f9b2-report.md`
   - Full execution log
   - Includes setup, progress, debug info
   - Deleted after 7 days

2. **Output file** (final): `reports/q4-analysis.md`
   - Clean, polished results only
   - No debug/setup info
   - Permanent storage

`/background-results` shows:
- Report file content (if agent running or just completed)
- Output file path (if specified)
- Both available for inspection

## Watch Mode

For running agents, use `--watch` to see results update in real-time:

```bash
/background-results agent-b7e2c1 --watch
```

Output refreshes every 5 seconds:
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Agent: copywriter-LinkedIn (agent-b7e2c1) [LIVE]       â”‚
â”‚ Status: running ğŸŸ¢ | Progress: 70% | Refreshing...     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[... report content auto-updates ...]

Press Ctrl+C to stop watching
```

Updates include:
- New sections as they're added
- Progress indicators
- Latest tool calls
- Updated context usage

## Tail Mode

For long-running agents, use `--tail N` to see latest output:

```bash
/background-results agent-b7e2c1 --tail 100
```

Shows last 100 lines of report:
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Agent: copywriter-LinkedIn (agent-b7e2c1)              â”‚
â”‚ Showing: Last 100 lines of 856 total                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

### Variant 8: Storytelling Hook
**Target**: Creative Cara
**Angle**: Customer journey narrative

[... last 100 lines shown ...]

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

Full report: /background-results agent-b7e2c1
Watch mode: /background-results agent-b7e2c1 --watch
```

## Integration with Dev Docs

When agent spawned with `--task [task-name]`:
```bash
/background builder "Execute migration" --task email-migration
```

Results automatically linked to dev docs:
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Agent: builder-email-migration (agent-d4f8a9)          â”‚
â”‚ Task: email-migration                                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

# Email Template Migration - Execution Report

## Dev Docs Context
- Plan: /dev/active/email-migration/email-migration-plan.md
- Tasks: 12/18 complete (67%)
- Context: /dev/active/email-migration/email-migration-context.md

## Execution Log

[... detailed execution report ...]

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

Dev docs: /dev/active/email-migration/
View context: cat /dev/active/email-migration/email-migration-context.md
```

## Performance

### Result Retrieval Speed
- Small reports (<10 KB): <50ms
- Medium reports (10-100 KB): <200ms
- Large reports (>100 KB): <500ms

### Watch Mode Overhead
- Refresh interval: 5 seconds (configurable)
- CPU usage: <1% (file watching)
- No impact on agent performance

### Storage
- Report files: 2-50 KB typical
- Retention: 7 days (auto-cleanup)
- Location: `/tmp/agents/` (ephemeral)

## Best Practices

### 1. Check Status First
```bash
# Always check status before viewing results
/background-status agent-a3f9b2

# Then view results
/background-results agent-a3f9b2
```

### 2. Save Important Results
```bash
# Don't rely on temp report files
/background-results agent-a3f9b2 --output reports/saved-analysis.md

# Or spawn with --output from start
/background analyst "Analyze data" --output reports/analysis.md
```

### 3. Use Watch Mode for Long Tasks
```bash
# Monitor progress on 30+ minute tasks
/background-results agent-d4f8a9 --watch

# Check periodically instead of repeatedly querying
```

### 4. Tail for Quick Checks
```bash
# See latest progress without full report
/background-results agent-b7e2c1 --tail 50

# Faster than loading full report
```

### 5. JSON for Automation
```bash
# Extract specific data for scripts
/background-results agent-a3f9b2 --format json | jq '.summary.insights'

# Parse results programmatically
```

## Error Handling

### Agent Not Found
```
Error: Agent agent-xyz123 not found
Check agents: /background-status all
```

### Report File Missing
```
Error: Report file not found for agent-a3f9b2
Location: /tmp/agents/agent-a3f9b2-report.md

Possible causes:
- Agent failed before writing report
- File manually deleted
- Agent still initializing (wait 30s)
```

### Empty Results
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Agent: scout-find-files (agent-c1d6e8)                 â”‚
â”‚ Status: running ğŸŸ¢ (1m 23s)                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[No results yet - agent still initializing]

Check back in 2-3 minutes
Watch progress: /background-results agent-c1d6e8 --watch
```

### Failed Agent Results
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Agent: builder-deploy (agent-a8c2d4)                   â”‚
â”‚ Status: failed âœ— (timeout after 60m)                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

# Deployment Execution Report

## Phases Completed (3/5)
âœ“ Phase 1: Preparation
âœ“ Phase 2: Build
âœ“ Phase 3: Test

## Failure Point
âœ— Phase 4: Deploy
Error: Connection timeout to production server

## Partial Results
[... what was completed before failure ...]

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

Review failure: /background-status agent-a8c2d4
Retry: /background builder "Deploy with retry" --retry 3
```

## Advanced Usage

### Diff Results (Before/After)
```bash
# Save initial results
/background-results agent-a3f9b2 --output results-v1.md

# Agent updates, save again
/background-results agent-a3f9b2 --output results-v2.md

# Compare changes
diff results-v1.md results-v2.md
```

### Extract Sections
```bash
# Extract specific section with sed
/background-results agent-a3f9b2 | sed -n '/## Recommendations/,/##/p'

# Extract JSON data
/background-results agent-a3f9b2 --format json | jq '.results.content'
```

### Combine Multiple Results
```bash
# Aggregate results from multiple scouts
for id in agent-c1d6e8 agent-f9b3a7; do
  /background-results $id --format json >> combined-scout-results.json
done
```

### Filter by Keyword
```bash
# Search results for specific terms
/background-results agent-a3f9b2 | grep -A 5 "recommendation"

# Count occurrences
/background-results agent-a3f9b2 | grep -c "persona"
```

## Troubleshooting

### Incomplete Results
- Agent may still be running: `/background-status agent-id`
- Wait for completion: `/background-results agent-id --watch`
- Check for errors in status

### Garbled Output
- Check file encoding: `file /tmp/agents/agent-*/report.md`
- Verify markdown formatting
- Try plain text: `--format text`

### Large Files Slow
- Use tail mode: `--tail 100`
- Paginate: `--tail 100 --offset 200`
- Save to file and open in editor

### Results Disappeared
- Check retention: Files deleted after 7 days
- Always save important results to permanent location
- Use `--output` flag on agent spawn

## See Also

- `/background` - Spawn background agents
- `/background-status` - Check agent progress
- `/observe` (Phase 19) - Live dashboard monitoring
- `/agent-cleanup` (Phase 20) - Clean up old reports
- `/cost-report` (Phase 19) - Analyze agent costs
- `.claude/hooks/background-agent.ts` - Background agent implementation
- `docs/WORKFLOW-PATTERNS.md` - Scout/Plan/Build patterns

---

**Phase 18.5 - Background Agent Execution**
**Status:** Implementation
**Integration:** Dev docs, observability (Phase 19), cleanup (Phase 20)
