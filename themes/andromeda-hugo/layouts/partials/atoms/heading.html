{{/*
  Heading Atom - Semantic heading component with BEM naming

  Usage:
    {{ partial "atoms/heading.html" (dict
      "text" "Page Title"
      "level" 2
      "variant" "primary"
      "align" "center"
      "class" "mb-4"
      "subtitle" "Optional subtitle text"
      "markdown" true
    )}}

  Parameters:
    text (required) - Heading text content
    level (optional) - Heading level 1-6 (default: 2)
    variant (optional) - Color variant: primary|secondary|tertiary|success|warning|error|info|neutral (default: "")
    display (optional) - Display variant (very large text-5xl/6xl) - boolean (default: false)
    gradient (optional) - Apply gradient text effect - boolean (default: false)
    align (optional) - left|center|right (default: left)
    class (optional) - Additional CSS classes
    subtitle (optional) - Optional subtitle text below heading
    subtitleClass (optional) - CSS classes for subtitle
    markdown (optional) - Apply markdownify filter (default: false)
    id (optional) - HTML id attribute for anchor links
    attributes (optional) - Additional HTML attributes as dict
    weight (optional) - Font weight: normal|medium|semibold (default: medium for headings)

  Unified Color Variants (Phase 2):
    - primary: Emerald green (main actions, trust, professional)
    - secondary: Terracotta (warm actions, personal connection)
    - tertiary: Navy blue (informational, support)
    - success: Sage green (positive feedback, achievements)
    - warning: Amber (caution, important notices)
    - error: Red (errors, critical alerts)
    - info: Teal (informational content)
    - neutral: Gray (subtle, backgrounds)
*/}}

{{/* Parse parameters */}}
{{ $text := .text }}
{{ $level := .level | default 2 }}
{{ $variant := .variant | default "" }}
{{ $display := .display | default false }}
{{ $gradient := .gradient | default false }}
{{ $align := .align | default "left" }}
{{ $class := .class | default "" }}
{{ $subtitle := .subtitle }}
{{ $subtitleClass := .subtitleClass | default "c-heading__subtitle" }}
{{ $markdown := .markdown | default false }}
{{ $id := .id }}
{{ $attributes := .attributes | default dict }}
{{ $weight := .weight | default "medium" }}

{{/* Validate heading level */}}
{{ if or (lt $level 1) (gt $level 6) }}
  {{ $level = 2 }}
{{ end }}

{{/* Build BEM classes */}}
{{ $headingClass := "c-heading" }}

{{/* Add display variant modifier */}}
{{ if $display }}
  {{ $headingClass = printf "%s c-heading--display" $headingClass }}
{{ end }}

{{/* Add gradient text modifier */}}
{{ if $gradient }}
  {{ $headingClass = printf "%s c-heading--gradient" $headingClass }}
{{ end }}

{{/* Add color variant modifier */}}
{{ if $variant }}
  {{ $headingClass = printf "%s c-heading--%s" $headingClass $variant }}
{{ end }}

{{/* Add weight modifier */}}
{{ if eq $weight "normal" }}
  {{ $headingClass = printf "%s c-heading--weight-normal" $headingClass }}
{{ else if eq $weight "semibold" }}
  {{ $headingClass = printf "%s c-heading--weight-semibold" $headingClass }}
{{ end }}

{{/* Add alignment modifier */}}
{{ if eq $align "center" }}
  {{ $headingClass = printf "%s c-heading--center" $headingClass }}
{{ else if eq $align "right" }}
  {{ $headingClass = printf "%s c-heading--right" $headingClass }}
{{ end }}

{{/* Add custom classes */}}
{{ if $class }}
  {{ $headingClass = printf "%s %s" $headingClass $class }}
{{ end }}

{{/* Process text content */}}
{{ $content := $text }}
{{ if $markdown }}
  {{ $content = $text | markdownify }}
{{ end }}

{{/* Render heading element */}}
{{ if eq $level 1 }}<h1{{ with $id }} id="{{ . }}"{{ end }} class="{{ $headingClass }}"{{ range $key, $value := $attributes }} {{ $key }}="{{ $value }}"{{ end }}>{{ $content | safeHTML }}</h1>
{{ else if eq $level 2 }}<h2{{ with $id }} id="{{ . }}"{{ end }} class="{{ $headingClass }}"{{ range $key, $value := $attributes }} {{ $key }}="{{ $value }}"{{ end }}>{{ $content | safeHTML }}</h2>
{{ else if eq $level 3 }}<h3{{ with $id }} id="{{ . }}"{{ end }} class="{{ $headingClass }}"{{ range $key, $value := $attributes }} {{ $key }}="{{ $value }}"{{ end }}>{{ $content | safeHTML }}</h3>
{{ else if eq $level 4 }}<h4{{ with $id }} id="{{ . }}"{{ end }} class="{{ $headingClass }}"{{ range $key, $value := $attributes }} {{ $key }}="{{ $value }}"{{ end }}>{{ $content | safeHTML }}</h4>
{{ else if eq $level 5 }}<h5{{ with $id }} id="{{ . }}"{{ end }} class="{{ $headingClass }}"{{ range $key, $value := $attributes }} {{ $key }}="{{ $value }}"{{ end }}>{{ $content | safeHTML }}</h5>
{{ else if eq $level 6 }}<h6{{ with $id }} id="{{ . }}"{{ end }} class="{{ $headingClass }}"{{ range $key, $value := $attributes }} {{ $key }}="{{ $value }}"{{ end }}>{{ $content | safeHTML }}</h6>
{{ end }}

{{/* Render optional subtitle */}}
{{ with $subtitle }}
  <p class="{{ $subtitleClass }}">{{ . }}</p>
{{ end }}
