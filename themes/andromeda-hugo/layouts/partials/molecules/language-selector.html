{{/*
  Language Selector Molecule

  Displays language switcher for multilingual sites
  Supports both desktop and mobile variants

  Usage:
    {{ partial "molecules/language-selector.html" (dict "variant" "desktop" "context" .) }}
    {{ partial "molecules/language-selector.html" (dict "variant" "mobile" "context" .) }}

  Params:
    - variant: "desktop" or "mobile" (default: "desktop")
    - context: page context (required)
*/}}

{{ $variant := .variant | default "desktop" }}
{{ $context := .context | default . }}

{{/* Check if site has multiple languages */}}
{{ if gt (len site.Languages) 1 }}
  {{ if eq $variant "mobile" }}
    {{/* Mobile Language Selector */}}
    <div class="d-block d-lg-none text-center">
      <select
        class="mx-3 border-0 font-weight-bold"
        id="select-language-mobile"
        onchange="location = this.value;"
        aria-label="{{ i18n `select_language` | default `Select Language` }}">
        {{ $pageLang := $context.Lang }}
        {{/* Loop through all site languages */}}
        {{ range site.Languages }}
          {{ $langCode := .Lang }}
          {{ $langName := .LanguageName }}
          {{/* Check if this is the current language */}}
          {{ if eq $langCode $pageLang }}
            <option value="{{ $context.RelPermalink }}" selected>
              {{ $langName }}
            </option>
          {{ else }}
            {{/* Find translation for this language */}}
            {{ range $context.Translations }}
              {{ if eq .Lang $langCode }}
                <option value="{{ .RelPermalink }}">
                  {{ $langName }}
                </option>
              {{ end }}
            {{ end }}
          {{ end }}
        {{ end }}
      </select>
    </div>
  {{ else }}
    {{/* Desktop Language Selector */}}
    <div class="d-none d-lg-inline text-center">
      <select
        class="mx-3 border-0 font-weight-bold"
        id="select-language-desktop"
        onchange="location = this.value;"
        aria-label="{{ i18n `select_language` | default `Select Language` }}">
        {{ $pageLang := $context.Lang }}
        {{/* Loop through all site languages */}}
        {{ range site.Languages }}
          {{ $langCode := .Lang }}
          {{ $langName := .LanguageName }}
          {{/* Check if this is the current language */}}
          {{ if eq $langCode $pageLang }}
            <option value="{{ $context.RelPermalink }}" selected>
              {{ $langName }}
            </option>
          {{ else }}
            {{/* Find translation for this language */}}
            {{ range $context.Translations }}
              {{ if eq .Lang $langCode }}
                <option value="{{ .RelPermalink }}">
                  {{ $langName }}
                </option>
              {{ end }}
            {{ end }}
          {{ end }}
        {{ end }}
      </select>
    </div>
  {{ end }}
{{ end }}
