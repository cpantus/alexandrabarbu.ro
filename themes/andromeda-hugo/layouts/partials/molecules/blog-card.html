{{/*
  Blog Card Molecule - Article/resource card with image, title, excerpt, and metadata

  Usage:
    {{ partial "molecules/blog-card.html" (dict
      "image" "images/blog/article.jpg"
      "title" "Understanding Anxiety"
      "description" "Learn about anxiety triggers and coping strategies..."
      "link" "/blog/understanding-anxiety"
    )}}

  Parameters:
    title (required) - Card title
    link (optional) - Link URL
    image (optional) - Featured image path
    description (optional) - Article excerpt/description
    date (optional) - Publication date
    author (optional) - Author name
    category (optional) - Category name (for filtering)
    type (optional) - Badge type text (e.g., "Article", "Video", "Guide")
    readTime (optional) - Reading time (e.g., "5 min")
    class (optional) - Additional CSS classes
    aos (optional) - AOS animation name
    aosDelay (optional) - AOS delay in ms

  Metadata display:
    - Shows date, author, read time if provided
    - Category used for data-category attribute (filtering)
    - Type badge displayed over image

  Examples:
    Full blog card:
      {{ partial "molecules/blog-card.html" (dict
        "image" "images/blog/anxiety.jpg"
        "title" "Managing Workplace Anxiety"
        "description" "Practical strategies for reducing stress at work..."
        "link" "/blog/workplace-anxiety"
        "date" "2025-01-15"
        "author" "Dr. Alexandra Barbu"
        "category" "anxiety"
        "type" "Article"
        "readTime" "8 min"
        "aos" "fade-up"
      )}}

    Simple resource card:
      {{ partial "molecules/blog-card.html" (dict
        "title" "CBT Techniques Guide"
        "description" "Download our free guide to cognitive behavioral therapy techniques."
        "link" "/resources/cbt-guide.pdf"
        "type" "PDF Guide"
      )}}
*/}}

{{ $title := .title }}
{{ $link := .link }}
{{ $image := .image }}
{{ $description := .description }}
{{ $date := .date }}
{{ $author := .author }}
{{ $category := .category | default "all" }}
{{ $type := .type }}
{{ $readTime := .readTime }}
{{ $class := .class | default "" }}
{{ $aos := .aos }}
{{ $aosDelay := .aosDelay }}

{{/* Build AOS attributes */}}
{{ $aosAttrs := "" }}
{{ if $aos }}
  {{ $aosAttrs = printf `data-aos="%s"` $aos }}
  {{ if $aosDelay }}
    {{ $aosAttrs = printf `%s data-aos-delay="%d"` $aosAttrs $aosDelay }}
  {{ end }}
{{ end }}

<div class="blog-card-molecule {{ $class }}" data-category="{{ $category }}">
  <div class="card blog-card h-100 border-0 shadow-sm" {{ $aosAttrs | safeHTMLAttr }}>
    {{/* Featured Image with Badge */}}
    {{ if $image }}
      <div class="blog-card-image position-relative">
        {{ partial "atoms/image.html" (dict
          "src" $image
          "alt" $title
          "class" "card-img-top"
        ) }}
        {{ if $type }}
          <span class="badge bg-secondary blog-badge position-absolute top-0 end-0 m-3">{{ $type }}</span>
        {{ end }}
      </div>
    {{ end }}

    {{/* Card Body */}}
    <div class="card-body d-flex flex-column">
      {{/* Metadata */}}
      {{ if or $date $author $readTime }}
        <div class="blog-meta mb-3 d-flex flex-wrap gap-3 text-muted small">
          {{ if $date }}
            <span>
              {{ partial "atoms/icon.html" (dict "name" "calendar" "size" "sm" "class" "me-1") }}
              {{ $date }}
            </span>
          {{ end }}
          {{ if $author }}
            <span>
              {{ partial "atoms/icon.html" (dict "name" "user" "size" "sm" "class" "me-1") }}
              {{ $author }}
            </span>
          {{ end }}
          {{ if $readTime }}
            <span>
              {{ partial "atoms/icon.html" (dict "name" "clock" "size" "sm" "class" "me-1") }}
              {{ $readTime }}
            </span>
          {{ end }}
        </div>
      {{ end }}

      {{/* Title */}}
      {{ if $title }}
        {{ if $link }}
          <a href="{{ $link | relLangURL }}" class="text-decoration-none">
            {{ partial "atoms/heading.html" (dict
              "text" $title
              "level" 4
              "class" "card-title mb-3"
              "markdown" true
            ) }}
          </a>
        {{ else }}
          {{ partial "atoms/heading.html" (dict
            "text" $title
            "level" 4
            "class" "card-title mb-3"
            "markdown" true
          ) }}
        {{ end }}
      {{ end }}

      {{/* Description/Excerpt */}}
      {{ if $description }}
        <p class="card-text flex-grow-1">{{ $description | markdownify }}</p>
      {{ end }}

      {{/* Read More Link */}}
      {{ if $link }}
        {{ partial "atoms/button.html" (dict
          "text" (i18n "read_more" | default "Citete mai mult")
          "href" ($link | relLangURL)
          "variant" "outline-primary"
          "size" "sm"
          "class" "mt-3 align-self-start"
        ) }}
      {{ end }}
    </div>
  </div>
</div>
