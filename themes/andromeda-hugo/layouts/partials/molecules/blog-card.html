{{/*
  Blog Card Molecule - Article/resource card with image, title, excerpt, and metadata
  BEM Component: .c-blog-card (refactored 2025-11-20)

  Usage:
    {{ partial "molecules/blog-card.html" (dict
      "image" "images/blog/article.jpg"
      "title" "Understanding Anxiety"
      "description" "Learn about anxiety triggers and coping strategies..."
      "link" "/blog/understanding-anxiety"
    )}}

  Parameters:
    title (required)      - Card title
    link (optional)       - Link URL (card becomes clickable if provided)
    image (optional)      - Featured image path
    description (optional) - Article excerpt/description
    date (optional)       - Publication date (displayed in metadata)
    author (optional)     - Author name (displayed in metadata)
    category (optional)   - Category name (for filtering via data-category attribute)
    type (optional)       - Badge type text (e.g., "Article", "Video", "Guide")
    readTime (optional)   - Reading time (e.g., "5 min")
    variant (optional)    - Color variant: "primary" (default), "secondary", "tertiary", "neutral"
    class (optional)      - Additional CSS classes

  Color Variants:
    - "primary" (default) - Emerald accent (professional, trust)
    - "secondary"        - Terracotta accent (warm, personal)
    - "tertiary"         - Blue accent (informational)
    - "neutral"          - Gray accent (subtle, low-emphasis)

  BEM Structure:
    .c-blog-card                    - Root element
    .c-blog-card--{variant}         - Color variant modifier
    .c-blog-card__image-wrapper     - Image container
    .c-blog-card__image             - Image element
    .c-blog-card__badge             - Type badge (overlaid on image)
    .c-blog-card__body              - Content container
    .c-blog-card__meta              - Metadata row (date, author, read time)
    .c-blog-card__meta-item         - Individual metadata item
    .c-blog-card__title             - Article title
    .c-blog-card__description       - Excerpt text
    .c-blog-card__action            - Action button container

  Features:
    - 4 semantic color variants (primary, secondary, tertiary, neutral)
    - Image with overlay badge for content type
    - Metadata with icon atoms (date, author, read time)
    - Heading atom integration with color variants
    - Button atom integration for "read more" action
    - Hover effects (lift card, highlight title)
    - Flexbox layout (description grows to fill space)
    - Responsive behavior (image aspect ratio maintains, text scales)
    - Parameter validation with clear error messages
    - Backward compatibility via SCSS @extend

  Examples:
    Full blog card with all metadata:
      {{ partial "molecules/blog-card.html" (dict
        "image" "images/blog/anxiety.jpg"
        "title" "Managing Workplace Anxiety"
        "description" "Practical strategies for reducing stress at work and maintaining mental health."
        "link" "/blog/workplace-anxiety"
        "date" "2025-01-15"
        "author" "Dr. Alexandra Barbu"
        "category" "anxiety"
        "type" "Article"
        "readTime" "8 min"
        "variant" "primary"
      )}}

    Simple resource card with minimal metadata:
      {{ partial "molecules/blog-card.html" (dict
        "title" "CBT Techniques Guide"
        "description" "Download our free guide to cognitive behavioral therapy techniques."
        "link" "/resources/cbt-guide.pdf"
        "type" "PDF Guide"
        "variant" "secondary"
      )}}

    Card without image:
      {{ partial "molecules/blog-card.html" (dict
        "title" "Understanding Cognitive Distortions"
        "description" "Learn to identify and challenge common thinking patterns that contribute to anxiety and depression."
        "link" "/blog/cognitive-distortions"
        "date" "2025-01-10"
        "readTime" "6 min"
        "variant" "tertiary"
      )}}

    Card without link (display only):
      {{ partial "molecules/blog-card.html" (dict
        "title" "Upcoming Workshop"
        "description" "Join us for a workshop on mindfulness and stress reduction techniques."
        "date" "2025-02-01"
        "variant" "neutral"
      )}}
*/}}

{{/* Parameter extraction with defaults */}}
{{ $title := .title }}
{{ $link := .link }}
{{ $image := .image }}
{{ $description := .description }}
{{ $date := .date }}
{{ $author := .author }}
{{ $category := .category | default "all" }}
{{ $type := .type }}
{{ $readTime := .readTime }}
{{ $variant := .variant | default "primary" }}
{{ $class := .class | default "" }}

{{/* Parameter validation */}}
{{ if not $title }}
  {{ errorf "[blog-card.html] Missing required parameter 'title' at %s" .Position }}
{{ end }}

{{/* Build BEM class with variant modifier */}}
{{ $bemClass := "c-blog-card" }}
{{ if $variant }}
  {{ $bemClass = printf "%s c-blog-card--%s" $bemClass $variant }}
{{ end }}
{{ if $class }}
  {{ $bemClass = printf "%s %s" $bemClass $class }}
{{ end }}

<div class="{{ $bemClass }}" data-category="{{ $category }}">
  {{/* Featured Image with Badge */}}
  {{ if $image }}
    <div class="c-blog-card__image-wrapper">
      {{ partial "atoms/image.html" (dict
        "src" $image
        "alt" $title
        "class" "c-blog-card__image"
      ) }}
      {{ if $type }}
        {{ partial "atoms/tag.html" (dict
          "text" $type
          "variant" $variant
          "class" "c-blog-card__badge"
        ) }}
      {{ end }}
    </div>
  {{ end }}

  {{/* Card Body */}}
  <div class="c-blog-card__body">
    {{/* Metadata */}}
    {{ if or $date $author $readTime }}
      <div class="c-blog-card__meta">
        {{ if $date }}
          <span class="c-blog-card__meta-item">
            {{ partial "atoms/icon.html" (dict
              "name" "calendar"
              "size" "sm"
              "variant" "neutral"
              "class" "c-blog-card__meta-icon"
            ) }}
            <span class="c-blog-card__meta-text">{{ $date }}</span>
          </span>
        {{ end }}
        {{ if $author }}
          <span class="c-blog-card__meta-item">
            {{ partial "atoms/icon.html" (dict
              "name" "user"
              "size" "sm"
              "variant" "neutral"
              "class" "c-blog-card__meta-icon"
            ) }}
            <span class="c-blog-card__meta-text">{{ $author }}</span>
          </span>
        {{ end }}
        {{ if $readTime }}
          <span class="c-blog-card__meta-item">
            {{ partial "atoms/icon.html" (dict
              "name" "clock"
              "size" "sm"
              "variant" "neutral"
              "class" "c-blog-card__meta-icon"
            ) }}
            <span class="c-blog-card__meta-text">{{ $readTime }}</span>
          </span>
        {{ end }}
      </div>
    {{ end }}

    {{/* Title */}}
    {{ if $title }}
      {{ if $link }}
        <a href="{{ $link | relLangURL }}" class="c-blog-card__title-link">
          {{ partial "atoms/heading.html" (dict
            "text" $title
            "level" 4
            "variant" $variant
            "class" "c-blog-card__title"
            "markdown" true
          ) }}
        </a>
      {{ else }}
        {{ partial "atoms/heading.html" (dict
          "text" $title
          "level" 4
          "variant" $variant
          "class" "c-blog-card__title"
          "markdown" true
        ) }}
      {{ end }}
    {{ end }}

    {{/* Description/Excerpt */}}
    {{ if $description }}
      <p class="c-blog-card__description">{{ $description | markdownify }}</p>
    {{ end }}

    {{/* Read More Link */}}
    {{ if $link }}
      <div class="c-blog-card__action">
        {{ partial "atoms/button.html" (dict
          "text" (i18n "read_more" | default "Citeste mai mult")
          "href" ($link | relLangURL)
          "variant" (printf "outline-%s" $variant)
          "size" "sm"
        ) }}
      </div>
    {{ end }}
  </div>
</div>
