{{/*
  Emergency Banner Molecule - Crisis resources banner
  BEM Component: .c-emergency-banner (refactored 2025-11-20)

  Usage:
    {{ partial "molecules/emergency-banner.html" (dict "variant" "warning") }}

  Parameters:
    variant (optional) - Color variant: "warning" (default), "error", "info", "primary"
    class (optional)   - Additional CSS classes

  Color Variants:
    - "warning" (default) - Amber/orange accent (urgent attention)
    - "error"            - Red accent (critical emergency)
    - "info"             - Blue accent (informational)
    - "primary"          - Emerald accent (supportive)

  BEM Structure:
    .c-emergency-banner              - Root container (fixed top banner)
    .c-emergency-banner--{variant}   - Color variant modifier
    .c-emergency-banner--hiding      - Hiding state modifier (added by JS during dismissal)
    .c-emergency-banner__container   - Content container (max-width wrapper)
    .c-emergency-banner__content     - Flexbox content wrapper
    .c-emergency-banner__icon        - Alert icon (uses icon atom)
    .c-emergency-banner__text        - Text content area
    .c-emergency-banner__title       - Bold title text
    .c-emergency-banner__message     - Hotline/support message
    .c-emergency-banner__close       - Close button (uses icon atom)

  Features:
    - Psychology practice crisis support (Telefonul Sufletului 24/7)
    - Dismissible with sessionStorage (persists across page navigation in session)
    - Fixed top positioning (doesn't block content)
    - Icon atom integration (alert-circle + x icons)
    - 4 color variants for different urgency levels
    - Responsive layout (stack on mobile)
    - Slide-down animation on dismiss
    - Keyboard accessible (close button)
    - JavaScript extracted to emergency-banner.js file
    - Site param controlled (site.Params.emergency_banner.enable)

  JavaScript:
    - Loaded via assets/js/emergency-banner.js
    - Checks sessionStorage for 'emergency-banner-dismissed'
    - Hides banner if dismissed in current session
    - Adds .hiding class on dismiss, then removes from DOM
    - sessionStorage clears on browser close (shows again in new session)

  Site Params (config/_default/params.toml):
    [emergency_banner]
    enable = true  # Show/hide emergency banner globally

  i18n Keys (define in i18n/ro.yaml and i18n/en.yaml):
    - emergency_title: Banner title (default: "Criză? Ai nevoie de ajutor urgent?")
    - emergency_message: Hotline message (default: "Telefonul Sufletului: 0800 801 200 (gratuit, 24/7)")
    - close: Close button label (default: "Închide")

  Examples:
    Warning variant (default - urgent):
      {{ partial "molecules/emergency-banner.html" . }}

    Error variant (critical):
      {{ partial "molecules/emergency-banner.html" (dict "variant" "error") }}

    Info variant (informational):
      {{ partial "molecules/emergency-banner.html" (dict "variant" "info") }}

    Primary variant (supportive):
      {{ partial "molecules/emergency-banner.html" (dict "variant" "primary") }}
*/}}

{{ if site.Params.emergency_banner.enable }}
  {{/* Parameter extraction with defaults */}}
  {{ $variant := .variant | default "warning" }}
  {{ $class := .class | default "" }}

  {{/* Build BEM class with variant modifier */}}
  {{ $bemClass := "c-emergency-banner" }}
  {{ if $variant }}
    {{ $bemClass = printf "%s c-emergency-banner--%s" $bemClass $variant }}
  {{ end }}
  {{ if $class }}
    {{ $bemClass = printf "%s %s" $bemClass $class }}
  {{ end }}

  <div id="emergency-banner" class="{{ $bemClass }}">
    <div class="c-emergency-banner__container">
      <div class="c-emergency-banner__content">
        {{ partial "atoms/icon.html" (dict
          "name" "alert-circle"
          "size" "md"
          "variant" $variant
          "class" "c-emergency-banner__icon"
        ) }}
        <div class="c-emergency-banner__text">
          <strong class="c-emergency-banner__title">
            {{ i18n "emergency_title" | default "Criză? Ai nevoie de ajutor urgent?" }}
          </strong>
          <span class="c-emergency-banner__message">
            {{ i18n "emergency_message" | default "Telefonul Sufletului: 0800 801 200 (gratuit, 24/7)" }}
          </span>
        </div>
        <button
          id="emergency-close"
          class="c-emergency-banner__close"
          type="button"
          aria-label="{{ i18n `close` | default `Închide` }}">
          {{ partial "atoms/icon.html" (dict
            "name" "x"
            "size" "sm"
            "variant" "neutral"
          ) }}
        </button>
      </div>
    </div>
  </div>
{{ end }}
