{{/*
  Image partial wrapper - Backwards compatible with legacy API
  Now uses atoms/image.html for advanced Hugo image processing

  Legacy API:
    {{ partial "image.html" (dict "Src" "path" "Alt" "text" "Class" "classes" "Size" "800x") }}
*/}}
{{- $src := .Src -}}
{{- $alt := .Alt | default "image" -}}
{{- $class := .Class | default "img-fluid" -}}
{{- $size := .Size | default "" -}}

{{/* Parse size parameter (e.g., "800x", "800x600") */}}
{{- $width := 800 -}}
{{- $height := 0 -}}
{{- if $size -}}
  {{- $sizeParts := split $size "x" -}}
  {{- if ge (len $sizeParts) 1 -}}
    {{- $width = int (index $sizeParts 0) -}}
  {{- end -}}
  {{- if ge (len $sizeParts) 2 -}}
    {{- $height = int (index $sizeParts 1) -}}
  {{- end -}}
{{- end -}}

{{/* Handle external URLs - no processing */}}
{{- if hasPrefix $src "http" -}}
  <img src="{{ $src }}" alt="{{ $alt }}" class="{{ $class }}" loading="lazy">
{{- else -}}
  {{/* Use advanced atoms/image.html for local images */}}
  {{- partial "atoms/image.html" (dict
    "src" $src
    "alt" $alt
    "width" $width
    "height" (cond (gt $height 0) $height nil)
    "class" $class
    "lazy" true
    "webp" true
    "responsive" true
  ) -}}
{{- end -}}
