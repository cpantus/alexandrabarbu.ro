{{/* Self-contained script partial for atomic design architecture */}}
{{/* No Bootstrap JS or jQuery dependencies - pure vanilla JS */}}

{{/* Main theme scripts - only include existing JS files */}}
{{ $scripts := slice }}

{{/* Add existing theme JavaScript files */}}
{{ range (slice "js/values-compass-interactions.js" "js/stats-counter.js" "js/scroll-animations.js" "js/gsap-enhancements.js") }}
  {{ $resource := resources.Get . }}
  {{ if $resource }}
    {{ $scripts = $scripts | append $resource }}
  {{ end }}
{{ end }}

{{/* Concatenate and minify if we have scripts */}}
{{ if gt (len $scripts) 0 }}
  {{ $bundled := $scripts | resources.Concat "js/bundle.js" | minify | fingerprint "sha512" }}
  <script crossorigin="anonymous" defer="defer" integrity="{{ $bundled.Data.Integrity }}" type="application/javascript">{{ $bundled.Content | safeJS }}</script>
{{ end }}

{{/* Font loading - only if configured */}}
{{ $pf := site.Params.variables.font_primary }}
{{ $sf := site.Params.variables.font_secondary }}
{{ if or $pf $sf }}
<script type="application/javascript">
  if (typeof WebFont !== 'undefined') {
    WebFont.load({
      google: {
        api: 'https://fonts.googleapis.com/css2',
        families: ['{{$pf | default `Poppins:wght@300;400;600;700`}}{{if not $sf}}&display=swap{{end}}'{{with $sf}},'{{. | default `Open Sans:wght@300;400;600;700`}}&display=swap'{{end}}],
        version: 2
      },
      active: () => {
        sessionStorage.fontsLoaded = true
      }
    });
  }
</script>
{{ end }}

{{/* Optional partials - only include if they exist */}}
{{ with site.Params.pwa }}
  {{ partialCached "pwa.html" $ }}
{{ end }}

{{ with site.Params.cookies }}
  {{ partialCached "cookie-consent.html" $ }}
{{ end }}

{{ with site.Params.google_adsense }}
  {{ partialCached "adsense-script.html" $ }}
{{ end }}
