{{/*
  Footer Organism - BEM Refactored

  Main site footer composition using atomic design molecules

  Features:
  - Optional CTA section before footer
  - Logo and site info (footer-info molecule)
  - Social links and quick links (footer-nav molecule)
  - Copyright notice with legal links
  - 8pt spacing grid throughout

  BEM Structure:
  - Block: .c-footer
  - Elements: __cta, __cta-container, __cta-content, __cta-title, __cta-text,
              __cta-button, __main, __container, __divider, __content, __copyright,
              __copyright-container, __copyright-text
  - Modifiers: --with-cta (applied when CTA enabled)

  Usage:
    {{ partial "organisms/footer.html" . }}
    {{ partialCached "organisms/footer.html" . .Language }}  // With caching

  Dependencies:
  - molecules/footer-info.html (logo + description)
  - molecules/footer-nav.html (social links + quick links)
  - atoms/button.html (CTA button)
  - atoms/heading.html (CTA title)

  Accessibility:
  - Semantic HTML footer element
  - WCAG AA contrast
  - Keyboard navigation
  - Screen reader support

  Responsive:
  - Mobile (<768px): Stacked layout
  - Tablet (768-991px): 2-column grid
  - Desktop (>=992px): 3-column grid

  Version: 5.0.1 (Phase 4 - Organism Refactor)
  Last Updated: 2025-11-20
*/}}

{{- $currentLang := site.Language.Lang -}}
{{- $hasCTA := and site.Params.cta site.Params.cta.enable -}}

{{/* Optional CTA Section */}}
{{ if $hasCTA }}
<section class="c-footer__cta">
  <div class="c-footer__cta-container">
    <div class="c-footer__cta-content">
      {{ partial "atoms/heading.html" (dict
        "level" "h2"
        "text" (i18n "footer_cta_title" | default site.Params.cta.title)
        "variant" "gradient"
        "alignment" "center"
        "context" .
      ) }}
      <p class="c-footer__cta-text">{{ (i18n "footer_cta_content" | default site.Params.cta.content) | markdownify }}</p>
      <div class="c-footer__cta-button">
        {{ partial "atoms/button.html" (dict
          "text" (i18n "footer_cta_button" | default site.Params.cta.button)
          "href" site.Params.cta.button_link
          "variant" "primary"
          "size" "lg"
        ) }}
      </div>
    </div>
  </div>
</section>
{{ end }}

{{/* Main Footer */}}
<footer class="c-footer {{ if $hasCTA }}c-footer--with-cta{{ end }}">
  <div class="c-footer__main">
    <div class="c-footer__container">
      <div class="c-footer__divider"></div>
      <div class="c-footer__content">
        {{/* Column 1: Logo & Description (wider) */}}
        <div class="c-footer-info">
          <div class="c-footer-info__logo-section">
            <a
              class="c-footer-info__logo-link"
              href="{{ site.BaseURL | relLangURL }}"
              aria-label="{{ site.Title }}">
              {{ partial "molecules/logo.html" (dict "color" "primary" "size" "md" "link" false "context" .) }}
            </a>
            {{ with site.Params.footer_info }}
              <p class="c-footer-info__description">
                {{ . | markdownify }}
              </p>
            {{ end }}
          </div>
        </div>

        {{/* Column 2: Contact Info */}}
        {{ with site.Params.contact_info }}
          <div class="c-footer-nav__section c-footer-nav__section--contact">
            {{ partial "atoms/heading.html" (dict
              "text" (i18n "location_contact" | default "Contact")
              "level" 4
              "variant" "primary"
              "class" "c-footer-nav__title"
            ) }}
            <ul class="c-footer-nav__links">
              {{ with .address }}
                <li class="c-footer-nav__item">
                  {{ . | markdownify }}
                </li>
              {{ end }}
              {{ range first 1 .phone }}
                {{ if . }}
                  <li class="c-footer-nav__item">
                    <a href="tel:{{ . }}" class="c-footer-nav__link">{{ . }}</a>
                  </li>
                {{ end }}
              {{ end }}
              {{/* Add Email to Contact Column */}}
              {{ with .email }}
                {{ range first 1 . }}
                  {{ if . }}
                    <li class="c-footer-nav__item">
                      <a href="mailto:{{ . }}" class="c-footer-nav__link">{{ . }}</a>
                    </li>
                  {{ end }}
                {{ end }}
              {{ end }}
            </ul>
          </div>
        {{ end }}

        {{/* Column 3: Social Links Only */}}
        <div class="c-footer-nav__section c-footer-nav__section--social">
          {{ partial "atoms/heading.html" (dict
            "text" (i18n "socials" | default "Social Media")
            "level" 4
            "variant" "primary"
            "class" "c-footer-nav__title"
          ) }}

          {{/* Social Media Links */}}
          {{ with site.Params.social }}
            <div class="c-footer-nav__social">
              {{ partial "molecules/social-links.html" (dict
                "links" .
                "variant" "primary"
                "layout" "inline"
                "size" "lg"
                "class" "c-footer-nav__social-links"
              ) }}
            </div>
          {{ end }}
        </div>

        {{/* Column 4: Quick Links */}}
        <div class="c-footer-nav__section c-footer-nav__section--links">
          {{ partial "atoms/heading.html" (dict
            "text" (i18n "quick_links" | default "Link-uri Rapide")
            "level" 4
            "variant" "primary"
            "class" "c-footer-nav__title"
          ) }}

          {{/* Quick Links from Footer Menu */}}
          {{ if site.Menus.footer }}
            <ul class="c-footer-nav__links">
              {{ range site.Menus.footer }}
                <li class="c-footer-nav__item">
                  <a href="{{ .URL | relLangURL }}" class="c-footer-nav__link">
                    {{ .Name }}
                  </a>
                </li>
              {{ end }}
            </ul>
          {{ end }}
        </div>
      </div>
    </div>
  </div>
</footer>

{{/* Copyright */}}
<div class="c-footer__copyright">
  <div class="c-footer__copyright-container">
    <p class="c-footer__copyright-text">{{ site.Params.copyright | markdownify }}</p>
  </div>
</div>
