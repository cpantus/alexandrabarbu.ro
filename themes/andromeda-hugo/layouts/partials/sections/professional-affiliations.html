{{/* Professional Affiliations Section - Display membership logos and certifications */}}
{{- $section := .Params.professional_affiliations -}}

{{- with $section -}}
  {{- if .enable -}}
    <section class="section professional-affiliations {{ if .background }}bg-{{ .background }}{{ else }}bg-light{{ end }}">
      <div class="container">
        <div class="row">
          <div class="col-lg-12">
            {{- if or .subtitle .title .description -}}
              <div class="section-title text-center mb-5" data-aos="fade-up">
                {{- if .subtitle -}}
                  <p class="subtitle text-muted">{{ .subtitle | markdownify }}</p>
                {{- end -}}
                {{- if .title -}}
                  {{ partial "atoms/heading.html" (dict
                    "text" .title
                    "level" 2
                    "class" "title mb-3"
                  ) }}
                {{- end -}}
                {{- if .description -}}
                  <p class="lead text-muted">{{ .description | markdownify }}</p>
                {{- end -}}
              </div>
            {{- end -}}

            <div class="affiliations-grid row g-4 justify-content-center align-items-center">
              {{- range $index, $affiliation := .affiliations -}}
                <div class="col-6 col-md-4 col-lg-3" data-aos="fade-up" data-aos-delay="{{ mul $index 100 }}">
                  <div class="affiliation-card text-center p-4">
                    {{- if .logo -}}
                      {{- $logoPath := printf "images/affiliations/%s" .logo -}}
                      {{ partial "atoms/image.html" (dict
                        "src" $logoPath
                        "alt" (printf "%s logo" .name)
                        "class" "affiliation-logo img-fluid mx-auto d-block"
                        "loading" "lazy"
                        "style" "max-height: 80px; filter: grayscale(100%); opacity: 0.7;"
                      ) }}
                    {{- end -}}
                    {{- if .name -}}
                      <p class="affiliation-name mt-3 mb-1 small fw-medium text-dark">{{ .name }}</p>
                    {{- end -}}
                    {{- if .membership_type -}}
                      <p class="affiliation-type mb-0 small text-muted">{{ .membership_type }}</p>
                    {{- end -}}
                    {{- if .url -}}
                      <a href="{{ .url }}"
                         target="_blank"
                         rel="noopener noreferrer"
                         class="stretched-link"
                         aria-label="{{ printf "Visit %s website" .name }}">
                      </a>
                    {{- end -}}
                  </div>
                </div>
              {{- end -}}
            </div>

            {{- if .verification_note -}}
              <div class="verification-note text-center mt-5" data-aos="fade-up">
                <p class="small text-muted">
                  {{ partial "atoms/icon.html" (dict "name" "shield-check" "class" "text-success me-1") }}
                  {{ .verification_note | markdownify }}
                </p>
              </div>
            {{- end -}}
          </div>
        </div>
      </div>
    </section>
  {{- end -}}
{{- end -}}
