{{/*
  ============================================================================
  Services Preview Section - BEM Architecture (Redesign 2025)
  ============================================================================
  Displays main therapy services in a responsive card grid with icon blobs

  Features:
  - 3-column grid (1 col mobile, 2 col tablet, 3 col desktop)
  - Icon blob backgrounds (organic shapes)
  - Service titles, descriptions
  - CTAs to individual service pages
  - Heavy card rounding (32px / 2rem)
  - Section badge pill
  - Centered intro text

  Data Structure:
  ---------------
  services_preview:
    badge: "Servicii Oferite"                  # Section badge (optional)
    title: "Începe Călătoria Ta"              # Section heading
    intro: "Centered intro text..."           # Optional intro paragraph
    services:                                   # Array of services (typically 3)
      - title: "Individual Therapy"
        description: "Personalized approach for depression, anxiety..."
        icon: "user"                           # Icon name (without 'las la-' prefix)
        icon_color: "blue"                     # Icon blob color: blue, sage, gold, coral, purple
        url: "/servicii/terapie-individuala/"
        button_text: "Explorează"              # Optional button text

  Parameters:
  -----------
  None - Data-driven from front matter

  Usage:
  ------
  ```yaml
  sections:
    - type: "services-preview"

  services_preview:
    title: "Cum Te Pot Ajuta"
    services:
      - title: "Terapie Individuală"
        description: "Abordare personalizată pentru depresie, anxietate..."
        icon: "las la-user"
        url: "/servicii/terapie-individuala/"
      - title: "Terapie de Cuplu"
        description: "Reconstruiește conexiunea și comunicarea..."
        icon: "las la-heart"
        url: "/servicii/terapie-cuplu/"
  ```

  BEM Structure:
  --------------
  .c-services-preview               - Section wrapper
  .c-services-preview__header       - Header container
  .c-services-preview__subtitle     - Eyebrow text
  .c-services-preview__title        - Main heading
  .c-services-preview__grid         - Services card grid
  .c-services-preview__card         - Individual service card
  .c-services-preview__icon         - Service icon
  .c-services-preview__card-title   - Service title
  .c-services-preview__description  - Service description
  .c-services-preview__cta          - CTA button

  Dependencies:
  -------------
  - atoms/heading.html (section title)
  - atoms/button.html (CTAs)
  - atoms/icon.html (service icons)
  - _services-preview.scss (BEM styles)

  Version: 1.0.0
  Updated: 2025-11-20
  ============================================================================
*/}}

{{- $data := .Params.services_preview -}}
{{- if not $data -}}
  {{- $data = site.Data.shared_sections.services_preview -}}
{{- end -}}

{{- if $data -}}
<section class="c-services-preview section">

  {{/* Section Badge Pill - positioned absolutely at section border */}}
  {{- if $data.badge -}}
    <span class="c-services-preview__badge">{{ $data.badge }}</span>
  {{- end -}}

  <div class="o-container">

    {{/* Section Header (Redesign 2025) */}}
    {{- if or $data.title $data.intro -}}
    <div class="c-services-preview__header text-center">
      {{/* Section Title */}}
      {{- if $data.title -}}
        {{ partial "atoms/heading.html" (dict
          "text" $data.title
          "level" 2
          "class" "c-services-preview__title"
        ) }}
      {{- end -}}

      {{/* Intro Text */}}
      {{- if $data.intro -}}
        <p class="c-services-preview__intro">{{ $data.intro | markdownify }}</p>
      {{- end -}}

      {{/* Bottom Link - "AFLĂ MAI MULTE DESPRE TERAPIE" (moved below intro) */}}
      {{- if $data.top_link -}}
      <div class="c-services-preview__bottom-link">
        <a href="{{ $data.top_link.url | relLangURL }}" class="c-services-preview__bottom-link-text">
          {{ $data.top_link.text | upper }}
        </a>
      </div>
      {{- end -}}
    </div>
    {{- end -}}

    {{/* Services Grid */}}
    {{- if $data.services -}}
    <div class="c-services-preview__grid">
      {{- range $index, $service := $data.services -}}
        <div class="c-services-preview__card" data-aos="fade-up" data-aos-delay="{{ mul $index 100 }}">

          {{/* Service Icon with Blob Background (Redesign 2025) */}}
          {{- if $service.icon -}}
            {{ partial "atoms/icon-blob.html" (dict
              "icon" (printf "las la-%s" $service.icon)
              "variant" (default "blue" $service.icon_color)
              "size" "lg"
              "class" "c-services-preview__icon-blob"
            ) }}
          {{- end -}}

          {{/* Service Title */}}
          {{- if $service.title -}}
            <h3 class="c-services-preview__card-title">{{ $service.title }}</h3>
          {{- end -}}

          {{/* Service Description */}}
          {{- if $service.description -}}
            <p class="c-services-preview__description">{{ $service.description }}</p>
          {{- end -}}

          {{/* Card Footer CTA Link */}}
          {{- if $service.url -}}
            <div class="c-services-preview__card-footer">
              <a href="{{ $service.url | relLangURL }}" class="c-services-preview__cta-link">
                {{ default "DETALII" $service.button_text }} →
              </a>
            </div>
          {{- end -}}

        </div>
      {{- end -}}
    </div>
    {{- end -}}

    {{/* Section-Level CTA */}}
    {{- if $data.section_cta -}}
    <div class="c-services-preview__section-cta text-center mt-5">
      {{ partial "atoms/button.html" (dict
        "text" $data.section_cta.text
        "url" ($data.section_cta.url | relLangURL)
        "variant" (default "outline-secondary" $data.section_cta.variant)
        "size" "lg"
        "icon" $data.section_cta.icon
      ) }}
    </div>
    {{- end -}}

  </div>
</section>
{{- end -}}
