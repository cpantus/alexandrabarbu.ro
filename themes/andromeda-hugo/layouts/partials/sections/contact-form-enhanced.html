{{/*
==============================================================================
CONTACT FORM ENHANCED SECTION - BEM Refactored + Design v4.0 Enhanced
==============================================================================
Two-column layout with gradient contact panel on left, contact form on right.

FEATURES:
- Full BEM structure (.c-contact-form-section)
- Gradient background panel (emerald-700 → emerald-900)
- Glassmorphism contact info cards (phone, email, location)
- Organic blob background shapes
- Enhanced form with floating labels
- Loading and success states
- Trust badges as circular icons
- i18n support
- 4 color variants (primary, secondary, tertiary, neutral)
- Responsive layout (stacks on mobile, form first)
- reCAPTCHA v3 spam protection
- Honeypot field + time-based validation

USAGE:
sections:
  - type: "contact-form-enhanced"

contact_form_enhanced:
  variant: "primary"                    # Optional: primary|secondary|tertiary|neutral
  contact_info:                         # Required: Contact information cards
    - type: "phone"
      icon: "phone"
      title: "Telefon"
      value: "+40 123 456 789"
      metadata: "Luni-Vineri, 9:00-18:00"
    - type: "email"
      icon: "envelope"
      title: "Email"
      value: "contact@example.ro"
      metadata: "Răspuns în 24h"
    - type: "location"
      icon: "map-marker"
      title: "Adresă"
      value: "București, Sector 1"
      metadata: "Programare online disponibilă"
  trust_badges:                         # Optional: Circular trust badges
    - icon: "shield-check"
      text: "Confidențialitate"
    - icon: "clock"
      text: "Răspuns rapid"
    - icon: "calendar-check"
      text: "Flexibilitate"
    - icon: "heart"
      text: "Empatie"
  form_description: "Completează formularul..."
  privacy_note: "Confidențialitate 100% garantată"

SITE PARAMS REQUIRED:
params:
  contact_form_action: "https://formspree.io/f/your-form-id"

DEPENDENCIES:
- atoms/icon.html
- atoms/heading.html
- molecules/form-field.html
- atoms/button.html
- i18n translations
- assets/js/contact-form-handler.js
- reCAPTCHA v3 API
- _contact-form-enhanced.scss

VERSION: 4.0.0 (Design Enhancement Update)
LAST UPDATED: 2025-11-23
==============================================================================
*/}}

{{- $variant := .Params.contact_form_enhanced.variant | default "primary" -}}
{{- $contactInfo := .Params.contact_form_enhanced.contact_info -}}
{{- $trustBadges := .Params.contact_form_enhanced.trust_badges -}}
{{- $formDescription := .Params.contact_form_enhanced.form_description -}}
{{- $privacyNote := .Params.contact_form_enhanced.privacy_note -}}

<section class="c-contact-form-section c-contact-form-section--{{ $variant }}">
  <div class="o-container">
    <div class="c-contact-form-section__grid">

      {{/* LEFT PANEL: Gradient Background + Contact Info Cards */}}
      <div class="c-contact-form-section__panel">
        {{/* Organic blob shapes (decorative background) */}}
        <div class="c-contact-form-section__blob c-contact-form-section__blob--1" aria-hidden="true"></div>
        <div class="c-contact-form-section__blob c-contact-form-section__blob--2" aria-hidden="true"></div>

        <div class="c-contact-form-section__panel-content">
          {{/* Contact Info Cards */}}
          {{ with $contactInfo }}
          <div class="c-contact-form-section__contact-cards">
            {{ range . }}
            <div class="c-contact-form-section__contact-card">
              {{/* Icon circle */}}
              <div class="c-contact-form-section__contact-icon">
                {{ partial "atoms/icon.html" (dict
                  "name" .icon
                  "size" "sm"
                  "variant" "gradient"
                ) }}
              </div>

              {{/* Card content */}}
              <div class="c-contact-form-section__contact-content">
                <p class="c-contact-form-section__contact-title">{{ .title }}</p>
                <p class="c-contact-form-section__contact-value">{{ .value }}</p>
                {{ with .metadata }}
                  <p class="c-contact-form-section__contact-meta">{{ . }}</p>
                {{ end }}
              </div>
            </div>
            {{ end }}
          </div>
          {{ end }}

          {{/* Trust Badges - Circular Icons */}}
          {{ with $trustBadges }}
          <div class="c-contact-form-section__trust-grid">
            {{ range . }}
            <div class="c-contact-form-section__trust-item">
              <div class="c-contact-form-section__trust-icon">
                <i class="las la-{{ .icon }}"></i>
              </div>
              <p class="c-contact-form-section__trust-text">{{ .text }}</p>
            </div>
            {{ end }}
          </div>
          {{ end }}
        </div>
      </div>

      {{/* RIGHT PANEL: Contact Form */}}
      {{ with site.Params.contact_form_action }}
      <div class="c-contact-form-section__form-wrapper">
        <div class="c-contact-form-section__header">
          {{ partial "atoms/heading.html" (dict
            "text" (T "send_a_message" | default "Trimite un mesaj")
            "level" 3
            "variant" "gradient"
            "colorVariant" $variant
            "class" "c-contact-form-section__title"
          ) }}

          {{/* Form description */}}
          {{ with $formDescription }}
          <p class="c-contact-form-section__description">{{ . }}</p>
          {{ end }}

          {{/* Privacy note - prominent badge */}}
          {{ with $privacyNote }}
          <div class="c-contact-form-section__privacy-note">
            <i class="las la-lock c-contact-form-section__privacy-icon"></i>
            <span class="c-contact-form-section__privacy-text">{{ . }}</span>
          </div>
          {{ end }}
        </div>

        <form id="contact-form" class="c-contact-form-section__form" action="{{ . }}" method="POST" data-action="{{ . }}">
          {{/* Status messages container */}}
          <div id="form-status" class="c-contact-form-section__status"></div>

          {{/* Form fields - using enhanced molecule with floating labels */}}
          {{ partial "molecules/form-field.html" (dict
            "type" "text"
            "name" "name"
            "id" "name"
            "label" (T "full_name" | default "Nume complet")
            "required" true
            "variant" $variant
            "class" "c-contact-form-section__field"
          ) }}

          {{ partial "molecules/form-field.html" (dict
            "type" "email"
            "name" "email"
            "id" "email"
            "label" (T "email" | default "Email")
            "required" true
            "variant" $variant
            "class" "c-contact-form-section__field"
          ) }}

          {{ partial "molecules/form-field.html" (dict
            "type" "textarea"
            "name" "message"
            "id" "message"
            "label" (T "your_message" | default "Mesajul tău")
            "rows" 4
            "required" true
            "variant" $variant
            "class" "c-contact-form-section__field"
          ) }}

          {{/* Honeypot field (hidden bot trap) */}}
          <input type="text"
                 name="website"
                 class="honeypot-field"
                 tabindex="-1"
                 autocomplete="off"
                 aria-hidden="true"
                 style="position: absolute; left: -9999px; width: 1px; height: 1px; opacity: 0; pointer-events: none;">

          {{/* Submit button - full width with icon */}}
          {{ partial "atoms/button.html" (dict
            "text" (T "send_message" | default "Trimite mesaj")
            "type" "submit"
            "variant" $variant
            "size" "lg"
            "fullWidth" true
            "icon" "paper-plane"
            "class" "c-contact-form-section__submit"
          ) }}

          {{/* Loading state template (hidden, shown by JS) */}}
          <div class="c-contact-form-section__loading" style="display: none;">
            <div class="c-contact-form-section__spinner"></div>
            <p class="c-contact-form-section__loading-text">Se trimite...</p>
          </div>

          {{/* Success state template (hidden, shown by JS) */}}
          <div class="c-contact-form-section__success" style="display: none;">
            <div class="c-contact-form-section__success-icon">
              <i class="las la-check-circle"></i>
            </div>
            <p class="c-contact-form-section__success-text">Mesaj trimis cu succes!</p>
          </div>
        </form>
      </div>
      {{ end }}

    </div>
  </div>

  {{/* Load reCAPTCHA v3 script */}}
  <script src="https://www.google.com/recaptcha/api.js?render=6Ld0dcwrAAAAAOWMqwdKUMalBY_J-d1WTswuoRG8" async defer></script>

  {{/* Load contact form handler JavaScript */}}
  {{ $contactFormJS := resources.Get "js/contact-form-handler.js" }}
  {{ if $contactFormJS }}
    <script src="{{ $contactFormJS.RelPermalink }}" defer></script>
  {{ end }}
</section>
