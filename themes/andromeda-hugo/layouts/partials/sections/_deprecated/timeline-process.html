{{/* Timeline/Process Section - Visual journey through therapeutic stages */}}
{{ $section := .Params.timeline_process }}

{{ with $section }}
  {{ if .enable }}
    <section class="section timeline-process">
      <div class="container-xxl position-relative">
        <div class="row">
          <div class="col-lg-12">
            <div class="section-title text-center mb-5">
              {{ if .subtitle }}
                <p class="text-uppercase">{{ .subtitle | markdownify }}</p>
              {{ end }}
              {{ if .title }}
                {{- $headingVariant := .heading_color_variant | default "primary" -}}
                {{ partial "atoms/heading.html" (dict "level" "h2" "text" .title "class" "title" "markdown" true "colorVariant" $headingVariant) }}
              {{ end }}
              {{ if .description }}
                <p>{{ .description | markdownify }}</p>
              {{ end }}
            </div>

            <div class="timeline-wrapper">
              {{ range $index, $step := .steps }}
                {{- /* 3-color rotation: primary → secondary → coral */ -}}
                {{- $iconVariants := slice "primary" "secondary" "coral" -}}
                {{- $iconVariant := index $iconVariants (mod $index 3) -}}

                <div class="timeline-item {{ if modBool $index 2 }}timeline-item-right{{ else }}timeline-item-left{{ end }}"
                     data-aos="fade-up"
                     data-aos-delay="{{ mul $index 100 }}">
                  <div class="timeline-marker">
                    <div class="timeline-icon-wrapper">
                      {{ if .icon }}
                        {{ partial "atoms/icon.html" (dict
                          "name" .icon
                          "size" "lg"
                          "color" "white"
                          "withWrapper" true
                          "wrapperVariant" $iconVariant
                          "wrapperSize" "lg"
                        ) }}
                      {{ else }}
                        <div class="icon-circle icon-circle-{{ $iconVariant }} icon-circle-lg">
                          <span class="timeline-number">{{ add $index 1 }}</span>
                        </div>
                      {{ end }}
                    </div>
                  </div>
                  <div class="timeline-content card border-0 shadow-sm card-v4">
                    <div class="card-body">
                      {{ if .title }}
                        {{ partial "atoms/heading.html" (dict "level" "h4" "text" .title "class" "mb-2" "markdown" true) }}
                      {{ end }}
                      {{ if .description }}
                        <p class="mb-0">{{ .description | markdownify }}</p>
                      {{ end }}
                      {{ if .duration }}
                        <small class="text-muted">
                          {{ partial "atoms/icon.html" (dict "name" "clock" "size" "sm" "class" "me-1") }}
                          {{ .duration }}
                        </small>
                      {{ end }}
                    </div>
                  </div>
                </div>
              {{ end }}
            </div>
          </div>
        </div>
      </div>
    </section>
  {{ end }}
{{ end }}
