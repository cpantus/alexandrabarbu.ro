{{/* Method Tabs Section - Therapeutic methods with tab navigation */}}
{{ $section := .Params.method_tabs }}

{{ with $section }}
  {{ if .enable }}
    <section class="section method-tabs">
      <div class="container-xxl position-relative">
        <div class="row">
          <div class="col-lg-12">
            <div class="section-title text-center mb-5">
              {{ if .subtitle }}
                <p class="text-uppercase">{{ .subtitle | markdownify }}</p>
              {{ end }}
              {{ if .title }}
                <h2 class="title">{{ .title | markdownify }}</h2>
              {{ end }}
              {{ if .description }}
                <p>{{ .description | markdownify }}</p>
              {{ end }}
            </div>

            <div class="methods-tabs-wrapper">
              {{/* Tab Navigation */}}
              <ul class="nav nav-pills nav-justified mb-4" id="methodTabs" role="tablist">
                {{ range $index, $method := .methods }}
                  <li class="nav-item" role="presentation">
                    <button class="nav-link {{ if eq $index 0 }}active{{ end }}"
                            id="method-tab-{{ $index }}"
                            data-bs-toggle="pill"
                            data-bs-target="#method-{{ $index }}"
                            type="button"
                            role="tab"
                            aria-controls="method-{{ $index }}"
                            aria-selected="{{ if eq $index 0 }}true{{ else }}false{{ end }}">
                      {{ if .icon }}
                        <i class="ti-{{ .icon }} text-primary me-2"></i>
                      {{ end }}
                      {{ .short_name | default .name | default .title }}
                    </button>
                  </li>
                {{ end }}
              </ul>

              {{/* Tab Content */}}
              <div class="tab-content" id="methodTabsContent">
                {{ range $index, $method := .methods }}
                  <div class="tab-pane fade {{ if eq $index 0 }}show active{{ end }}"
                       id="method-{{ $index }}"
                       role="tabpanel"
                       aria-labelledby="method-tab-{{ $index }}">
                    <div class="card border-0 shadow-sm">
                      <div class="card-body p-5">
                        <div class="row align-items-center">
                          <div class="col-lg-12">
                            <h3 class="mb-3">{{ .title | default .name }}</h3>
                            {{ if .description }}
                              <p class="lead">{{ .description | markdownify }}</p>
                            {{ end }}

                            {{/* Support both old and new field names */}}
                            {{ if .what_is }}
                              <h5 class="text-primary mt-4">{{ i18n "what_is" | default "Ce este?" }}</h5>
                              <p>{{ .what_is | markdownify }}</p>
                            {{ end }}

                            {{ if .how_works }}
                              <h5 class="text-primary mt-4">{{ i18n "how_it_works" | default "Cum funcționează?" }}</h5>
                              <p>{{ .how_works | markdownify }}</p>
                            {{ end }}

                            {{/* Benefits / For What */}}
                            {{ if or .for_what .benefits .best_for }}
                              <h5 class="text-primary mt-4">{{ i18n "benefits" | default "Beneficii" }}</h5>
                              <ul class="list-unstyled check-list-2">
                                {{ range (or .for_what .benefits .best_for) }}
                                  <li class="mb-2">
                                    <i class="ti-check text-primary me-2"></i>
                                    {{ . | markdownify }}
                                  </li>
                                {{ end }}
                              </ul>
                            {{ end }}

                            {{/* Techniques (if present) */}}
                            {{ if .techniques }}
                              <h5 class="text-primary mt-4">{{ i18n "techniques" | default "Tehnici" }}</h5>
                              <ul class="list-unstyled">
                                {{ range .techniques }}
                                  <li class="mb-2">
                                    <i class="ti-arrow-right text-secondary me-2"></i>
                                    {{ . | markdownify }}
                                  </li>
                                {{ end }}
                              </ul>
                            {{ end }}

                            {{/* Additional info */}}
                            {{ if .duration }}
                              <p class="mt-3"><strong>{{ i18n "duration" | default "Durata" }}:</strong> {{ .duration }}</p>
                            {{ end }}
                            {{ if .success_rate }}
                              <p><strong>{{ i18n "success_rate" | default "Rată de succes" }}:</strong> {{ .success_rate }}</p>
                            {{ end }}
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                {{ end }}
              </div>
            </div>
          </div>
        </div>
      </div>
    </section>
  {{ end }}
{{ end }}
