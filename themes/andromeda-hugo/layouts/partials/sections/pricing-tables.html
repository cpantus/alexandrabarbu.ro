{{/*
==============================================================================
Pricing Tables Section - BEM Architecture (Enhanced v4.0)
==============================================================================

Enhanced v4.0 premium section with featured tier elevation, comparison tooltips,
monthly/yearly toggle, glassmorphism cards, and gradient borders.

DATA STRUCTURE:
===============
pricing_section (or pricing):
  enable: boolean
  title: string (optional section title)
  subtitle: string (optional section subtitle)

monthly_yearly_toggle: "toggle" (enables monthly/yearly switch)

offer: string (optional special offer badge, supports markdown)

pricing_card: array of pricing plans
  - name: string (plan name)
    currency: string (currency symbol, e.g., "$", "€", "RON")
    monthly_price: string (monthly price, e.g., "99")
    yearly_price: string (yearly price, e.g., "990")
    content: string (plan description, supports markdown)
    services: array of features (strings)
    featured: boolean (featured tier gets 1.08x scale + special styling)
    button_label: string (CTA button text)
    button_link: string (CTA button URL)
    button_variant: string (optional: "primary", "secondary", "tertiary", "neutral")

MOLECULES USED:
===============
- pricing-toggle.html (monthly/yearly switch)

ATOMS USED:
===========
- heading.html (optional section title)
- button.html (CTA buttons in cards)
- icon.html (checkmarks in feature lists)

BEM CLASSES:
============
.c-pricing                    - Section wrapper
.c-pricing__container         - Content container
.c-pricing__section-header    - Optional section title header
.c-pricing__subtitle          - Section subtitle text
.c-pricing__offer             - Special offer badge
.c-pricing__grid              - Cards grid wrapper (CSS Grid)
.c-pricing__card              - Individual pricing card
.c-pricing__card--featured    - Featured tier modifier (1.08x scale)
.c-pricing__header            - Card header section
.c-pricing__title             - Plan name (h3)
.c-pricing__description       - Plan description text
.c-pricing__price             - Price section wrapper
.c-pricing__price-wrapper     - Price flex container
.c-pricing__currency          - Currency symbol
.c-pricing__amount            - Price number
.c-pricing__period            - Billing period text (/month, /year)
.c-pricing__features          - Features list (ul)
.c-pricing__feature           - Feature list item (li) with checkmark
.c-pricing__button            - CTA button wrapper

FEATURES:
=========
- Featured tier elevation (1.08x scale on desktop)
- Monthly/yearly toggle with price animation
- Glassmorphism cards with gradient borders
- Special offer badge with emerald background
- Responsive grid (3 cols → 2 cols → 1 col)
- Checkmark icons for features
- Backward compatibility via SCSS @extend

USAGE EXAMPLE:
==============
```yaml
sections:
  - type: "pricing-tables"

pricing_section:
  enable: true

monthly_yearly_toggle: "toggle"

offer: "**Special Offer**: Save 20% on yearly plans!"

pricing_card:
  - name: "Basic"
    currency: "RON"
    monthly_price: "200"
    yearly_price: "2000"
    content: "Perfect for individuals"
    services:
      - "4 sessions per month"
      - "Email support"
      - "Session recordings"
    button_label: "Get Started"
    button_link: "/contact"
    button_variant: "primary"

  - name: "Premium"
    currency: "RON"
    monthly_price: "350"
    yearly_price: "3500"
    content: "For committed clients"
    services:
      - "8 sessions per month"
      - "Priority email support"
      - "Session recordings"
      - "Progress tracking"
    featured: true
    button_label: "Most Popular"
    button_link: "/contact"
    button_variant: "primary"

  - name: "Professional"
    currency: "RON"
    monthly_price: "500"
    yearly_price: "5000"
    content: "Comprehensive care"
    services:
      - "Unlimited sessions"
      - "24/7 priority support"
      - "Session recordings"
      - "Progress tracking"
      - "Family sessions"
    button_label: "Contact Us"
    button_link: "/contact"
    button_variant: "secondary"
```

VERSION: 5.0.1 (BEM Refactor)
UPDATED: 2025-11-20
==============================================================================
*/}}

{{- $pricing := .Params.pricing_section -}}
{{- if not $pricing -}}
  {{- $pricing = .Params.pricing -}}
{{- end -}}

{{- with $pricing -}}
  {{- if .enable -}}
    <section class="c-pricing">
      <div class="c-pricing__container o-container">
        {{/* Optional Section Title */}}
        {{- if or .title .subtitle -}}
          <div class="c-pricing__section-header">
            {{- if .title -}}
              {{ partial "atoms/heading.html" (dict
                "level" "h2"
                "text" .title
                "variant" "section"
                "align" "center"
              ) }}
            {{- end -}}
            {{- if .subtitle -}}
              <p class="c-pricing__subtitle">{{ .subtitle | markdownify }}</p>
            {{- end -}}
          </div>
        {{- end -}}

        {{/* Monthly/Yearly Toggle */}}
        {{- $toggle := $.Params.monthly_yearly_toggle -}}
        {{- if eq $toggle "toggle" -}}
          {{ partial "molecules/pricing-toggle.html" (dict
            "monthlyLabel" (T "monthly")
            "yearlyLabel" (T "yearly")
            "defaultYearly" false
          ) }}
        {{- end -}}

        {{/* Special Offer Badge */}}
        {{- with $.Params.offer -}}
          <div class="c-pricing__offer">
            {{ . | markdownify }}
          </div>
        {{- end -}}

        {{/* Pricing Cards Grid */}}
        <div class="c-pricing__grid">
          {{- range $index, $plan := $.Params.pricing_card -}}
            {{/* Determine button variant (default: primary for featured, secondary otherwise) */}}
            {{- $buttonVariant := "secondary" -}}
            {{- if $plan.featured -}}
              {{- $buttonVariant = "primary" -}}
            {{- end -}}
            {{- if $plan.button_variant -}}
              {{- $buttonVariant = $plan.button_variant -}}
            {{- end -}}

            <div class="c-pricing__card{{ if $plan.featured }} c-pricing__card--featured{{ end }}"{{ if $plan.featured }} data-featured-label="{{ T "featured" | default "Most Popular" }}"{{ end }}>
              {{/* Card Header */}}
              <div class="c-pricing__header">
                <h3 class="c-pricing__title">{{ $plan.name }}</h3>
                {{- with $plan.content -}}
                  <p class="c-pricing__description">{{ . | markdownify }}</p>
                {{- end -}}
              </div>

              {{/* Price Section */}}
              <div class="c-pricing__price">
                <div class="c-pricing__price-wrapper">
                  <span class="c-pricing__currency">{{ $plan.currency | default "$" }}</span>
                  {{- if $plan.monthly_price -}}
                    <span class="c-pricing__amount" data-monthly-price="{{ $plan.monthly_price }}"{{ with $plan.yearly_price }} data-yearly-price="{{ . }}"{{ end }}>{{ $plan.monthly_price }}</span>
                  {{- else if $plan.yearly_price -}}
                    <span class="c-pricing__amount">{{ $plan.yearly_price }}</span>
                  {{- end -}}
                  <span class="c-pricing__period">{{ if $plan.monthly_price }}/{{ T "month" | default "month" }}{{ else }}/{{ T "year" | default "year" }}{{ end }}</span>
                </div>
              </div>

              {{/* Features List */}}
              {{- with $plan.services -}}
                <ul class="c-pricing__features">
                  {{- range . -}}
                    <li class="c-pricing__feature">
                      {{ . | markdownify }}
                    </li>
                  {{- end -}}
                </ul>
              {{- end -}}

              {{/* CTA Button */}}
              <div class="c-pricing__button">
                {{ partial "atoms/button.html" (dict
                  "text" $plan.button_label
                  "url" ($plan.button_link | absLangURL)
                  "variant" $buttonVariant
                  "size" "lg"
                  "fullWidth" true
                ) }}
              </div>
            </div>
          {{- end -}}
        </div>
      </div>
    </section>
  {{- end -}}
{{- end -}}
