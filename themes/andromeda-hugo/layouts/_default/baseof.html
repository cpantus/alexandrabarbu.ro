
<!DOCTYPE html>
<html
  lang="{{ site.LanguageCode | default `en-US` }}"
  itemscope
  itemtype="http://schema.org/WebPage">
  <head>
    {{ partial "essentials/head.html" . }}

    <!-- Hreflang tags for multilingual SEO -->
    {{ partial "seo/hreflang-tags.html" . }}

    <!-- Style processing with proper global caching -->
    {{ if hugo.IsProduction }}
      {{ partialCached "essentials/style.html" . "global-styles" }}
    {{ else }}
      {{ partial "essentials/style.html" . }}
    {{ end }}

    <!-- Conditional page-specific CSS bundles -->
    {{- $pageType := .Type -}}
    {{- $sections := .Params.sections -}}

    {{/* Contact page CSS */}}
    {{- if or (eq $pageType "contact") (in .RelPermalink "/contact") -}}
      {{- $contactCSS := resources.Get "scss/pages/_contact.scss" | toCSS | minify | fingerprint -}}
      <link rel="stylesheet" href="{{ $contactCSS.RelPermalink }}" integrity="{{ $contactCSS.Data.Integrity }}">
    {{- end -}}

    {{/* Signup page CSS */}}
    {{- if or (eq $pageType "signup") (in .RelPermalink "/signup") -}}
      {{- $signupCSS := resources.Get "scss/pages/_signup.scss" | toCSS | minify | fingerprint -}}
      <link rel="stylesheet" href="{{ $signupCSS.RelPermalink }}" integrity="{{ $signupCSS.Data.Integrity }}">
    {{- end -}}

    {{/* PHASE 6 CLEANUP: Sections CSS removed (all styles now in main BEM system via 06-components/) */}}
    {{/*  Legacy conditional CSS loading removed - timeline, blog, newsletter, service section styles now in main CSS */}}
  </head>

  <body{{ if site.Params.design.headings_brand_color }} class="headings-brand-color"{{ end }}>
    <!-- Cache partials with proper cache keys -->
    {{ if hugo.IsProduction }}
      {{ partialCached "preloader.html" . "global-preloader" }}
      {{ partialCached "essentials/header.html" . .Language }}
    {{ else }}
      {{ partial "preloader.html" . }}
      {{ partial "essentials/header.html" . }}
    {{ end }}

    <main id="main-content">
      {{ block "main" . }}{{ end }}
    </main>

    <!-- Cache footer and scripts with proper keys -->
    {{ if hugo.IsProduction }}
      {{ partialCached "essentials/script.html" . "global-scripts" }}
      {{ partialCached "essentials/footer.html" . .Language }}
    {{ else }}
      {{ partial "essentials/script.html" . }}
      {{ partial "essentials/footer.html" . }}
    {{ end }}
  </body>
</html>
