// ==================================
// ACCORDION COMPONENT - BEM Architecture
// ==================================
//
// Purpose: Reusable collapsible accordion molecule (vanilla JS)
// Features: Glassmorphism, smooth animations, color variants, accessible
//
// Last Updated: 2025-11-20 (Phase 3 - Molecule Refactor)
// Version: 1.0.0 (ITCSS + BEM)
//
// BEM Structure:
// Block: .c-accordion
// Elements: __item, __header, __button, __button-text, __button-icon, __panel, __content
// Modifiers: --primary, --secondary, --tertiary, --neutral, --active
//

/*------------------------------------------------------------------
  # Base Accordion Block
-------------------------------------------------------------------*/

.c-accordion {
  display: flex;
  flex-direction: column;
  gap: var(--accordion-gap);
  max-width: var(--accordion-max-width);
  margin: 0 auto;
}

/*------------------------------------------------------------------
  # Accordion Item
-------------------------------------------------------------------*/

.c-accordion__item {
  background: var(--accordion-item-bg);
  @include glassmorphism($radius-md, 0.95);
  border-radius: var(--accordion-item-border-radius);
  overflow: hidden;
  box-shadow: var(--accordion-item-shadow);
  transition: var(--accordion-item-transition);
  position: relative;

  // Gradient left border (variant-specific)
  &::before {
    content: '';
    position: absolute;
    left: 0;
    top: 0;
    bottom: 0;
    width: var(--accordion-item-border-width);
    background: transparent;
    opacity: 0;
    transition: opacity 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  }

  // Hover effect
  &:hover {
    box-shadow: var(--accordion-item-shadow-hover);

    &::before {
      opacity: 0.6;
    }
  }

  // Active (expanded) state
  &--active {
    box-shadow: var(--accordion-item-shadow-active);

    &::before {
      opacity: 1;
    }

    .c-accordion__button-icon {
      transform: rotate(180deg);
    }

    .c-accordion__button-text {
      color: var(--accordion-button-text-color-active);
    }
  }
}

/*------------------------------------------------------------------
  # Accordion Header
-------------------------------------------------------------------*/

.c-accordion__header {
  // Container for button
}

/*------------------------------------------------------------------
  # Accordion Button
-------------------------------------------------------------------*/

.c-accordion__button {
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: var(--accordion-button-gap);
  width: 100%;
  padding: var(--accordion-button-padding);
  background: transparent;
  border: none;
  cursor: pointer;
  user-select: none;
  transition: var(--accordion-button-transition);
  text-align: left;

  &:hover {
    background: var(--accordion-button-bg-hover);
  }

  // Focus state for accessibility
  &:focus-visible {
    outline: 2px solid var(--accordion-icon-color);
    outline-offset: -2px;
  }

  @media (max-width: $breakpoint-md) {
    padding: var(--accordion-button-padding-tablet);
  }

  @media (max-width: $breakpoint-sm) {
    padding: var(--accordion-button-padding-mobile);
    gap: var(--accordion-button-gap-mobile);
  }
}

.c-accordion__button-text {
  font-family: var(--accordion-button-text-font-family);
  font-size: var(--accordion-button-text-font-size);
  font-weight: var(--accordion-button-text-font-weight);
  color: var(--accordion-button-text-color);
  line-height: var(--accordion-button-text-line-height);
  margin: 0;
  flex: 1;
  transition: var(--accordion-button-text-transition);

  @media (max-width: $breakpoint-md) {
    font-size: var(--accordion-button-text-font-size-tablet);
  }

  @media (max-width: $breakpoint-sm) {
    font-size: var(--accordion-button-text-font-size-mobile);
  }
}

.c-accordion__button-icon {
  width: var(--accordion-icon-size);
  height: var(--accordion-icon-size);
  border-radius: var(--accordion-icon-border-radius);
  display: flex;
  align-items: center;
  justify-content: center;
  background: var(--accordion-icon-bg);
  flex-shrink: 0;
  transition: var(--accordion-icon-transition);

  i {
    color: var(--accordion-icon-color);
    font-size: var(--accordion-icon-font-size);
    font-weight: var(--accordion-icon-font-weight);
    transition: color $duration-fast $easing-subtle;
  }

  .c-accordion__item--active & {
    background: var(--accordion-icon-bg-active);

    i {
      color: var(--accordion-icon-color-active);
    }
  }

  @media (max-width: $breakpoint-sm) {
    width: var(--accordion-icon-size-mobile);
    height: var(--accordion-icon-size-mobile);

    i {
      font-size: var(--accordion-icon-font-size-mobile);
    }
  }
}

/*------------------------------------------------------------------
  # Accordion Panel (Collapsible Content)
-------------------------------------------------------------------*/

.c-accordion__panel {
  // Height animation handled by vanilla-collapse.js via .collapse classes
  // Collapse utility classes defined in 05-objects/_collapse.scss
  // No max-height or overflow needed here to avoid conflicts

  // Accessibility: hidden state
  &[hidden] {
    display: block; // Override hidden for CSS animation
    visibility: hidden;
  }

  &:not([hidden]) {
    visibility: visible;
  }
}

.c-accordion__content {
  padding: var(--accordion-content-padding);
  border-top: var(--accordion-content-border-top);

  // Typography for content
  p {
    font-family: var(--accordion-content-font-family);
    font-size: var(--accordion-content-font-size);
    line-height: var(--accordion-content-line-height);
    color: var(--accordion-content-color);
    margin: var(--accordion-content-margin-top) 0 0;

    &:last-child {
      margin-bottom: 0;
    }
  }

  ul,
  ol {
    margin: var(--accordion-list-margin);
    padding-left: var(--accordion-list-padding);

    li {
      font-family: var(--accordion-content-font-family);
      font-size: var(--accordion-list-font-size);
      line-height: var(--accordion-list-line-height);
      color: var(--accordion-content-color);
      margin-bottom: var(--accordion-list-item-margin);
    }
  }

  @media (max-width: $breakpoint-md) {
    padding: var(--accordion-content-padding-tablet);

    p {
      font-size: var(--accordion-content-font-size-tablet);
    }
  }

  @media (max-width: $breakpoint-sm) {
    padding: var(--accordion-content-padding-mobile);

    p {
      font-size: var(--accordion-content-font-size-mobile);
      margin-top: var(--accordion-content-margin-top-mobile);
    }

    ul,
    ol {
      padding-left: var(--accordion-list-padding-mobile);

      li {
        font-size: var(--accordion-list-font-size-mobile);
      }
    }
  }
}

/*------------------------------------------------------------------
  # Color Variants (Block Modifiers)
-------------------------------------------------------------------*/

// Redesign variant (forest green - 2025 redesign)
.c-accordion--redesign {
  .c-accordion__item {
    border-radius: var(--accordion-item-border-radius-lg);
  }

  .c-accordion__item::before {
    background: var(--accordion-redesign-border);
  }

  .c-accordion__item--active .c-accordion__button-text {
    color: var(--accordion-redesign-text-active);
  }

  .c-accordion__button-icon {
    background: var(--accordion-redesign-icon-bg);

    i {
      color: var(--accordion-redesign-icon-color);
    }
  }

  .c-accordion__item--active .c-accordion__button-icon {
    background: var(--accordion-redesign-icon-bg-active);

    i {
      color: var(--accordion-icon-color-active);
    }
  }
}

// Primary variant (emerald)
.c-accordion--primary {
  .c-accordion__item::before {
    background: var(--accordion-primary-border);
  }

  .c-accordion__item--active .c-accordion__button-text {
    color: var(--accordion-primary-text-active);
  }
}

// Secondary variant (terracotta)
.c-accordion--secondary {
  .c-accordion__item::before {
    background: var(--accordion-secondary-border);
  }

  .c-accordion__item--active .c-accordion__button-text {
    color: var(--accordion-secondary-text-active);
  }

  .c-accordion__button-icon i {
    color: var(--accordion-secondary-icon-color);
  }
}

// Tertiary variant (navy)
.c-accordion--tertiary {
  .c-accordion__item::before {
    background: var(--accordion-tertiary-border);
  }

  .c-accordion__item--active .c-accordion__button-text {
    color: var(--accordion-tertiary-text-active);
  }

  .c-accordion__button-icon i {
    color: var(--accordion-tertiary-icon-color);
  }
}

// Neutral variant (gray)
.c-accordion--neutral {
  .c-accordion__item::before {
    background: var(--accordion-neutral-border);
  }

  .c-accordion__item--active .c-accordion__button-text {
    color: var(--accordion-neutral-text-active);
  }

  .c-accordion__button-icon i {
    color: var(--accordion-neutral-icon-color);
  }
}

/*------------------------------------------------------------------
  # Legacy Compatibility (Bootstrap â†’ BEM)
-------------------------------------------------------------------*/

// Bootstrap accordion classes mapped to BEM
.accordion {
  @extend .c-accordion;

  &-flush {
    // Flush variant removes outer borders (not implemented yet)
  }
}

.accordion-item {
  @extend .c-accordion__item;
}

.accordion-header {
  @extend .c-accordion__header;
}

.accordion-button {
  @extend .c-accordion__button;

  &:not(.collapsed) {
    // Active state
    & + .accordion-collapse {
      .accordion-body {
        // Open state
      }
    }
  }
}

.accordion-collapse {
  @extend .c-accordion__panel;

  // .show class handled by 05-objects/_collapse.scss
}

.accordion-body {
  @extend .c-accordion__content;
}

// ==================================
// USAGE GUIDE
// ==================================
//
// Basic accordion:
//   <div class="c-accordion">...</div>
//
// Accordion with variant:
//   <div class="c-accordion c-accordion--secondary">...</div>
//
// Accordion item structure:
//   <div class="c-accordion__item c-accordion__item--active">
//     <div class="c-accordion__header">
//       <button class="c-accordion__button">
//         <span class="c-accordion__button-text">Question</span>
//         <span class="c-accordion__button-icon">
//           <i class="las la-angle-down"></i>
//         </span>
//       </button>
//     </div>
//     <div class="c-accordion__panel c-accordion__panel--open">
//       <div class="c-accordion__content">
//         <p>Answer content...</p>
//       </div>
//     </div>
//   </div>
//
// VERSION HISTORY:
// 1.0.0 (2025-11-20) - Initial accordion molecule with BEM + 8pt grid + Playfair Display
//
