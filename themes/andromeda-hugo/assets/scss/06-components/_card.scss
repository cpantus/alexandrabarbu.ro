// ==================================
// CARD COMPONENT - BEM Architecture
// ==================================
//
// Purpose: Reusable card component with v4.0 styling
// Features: Glassmorphism, gradient effects, multiple variants
//
// Last Updated: 2025-11-19 (Phase 3 - Component BEM Refactoring)
// Version: 3.0.0 (ITCSS + BEM)
//
// BEM Structure:
// Block: .c-card
// Elements: __header, __title, __icon, __body, __footer, __meta, __action
// Modifiers: --primary, --secondary, --coral, --sage, --elevated, --glass, --gradient-border, --top-accent, --hover-lift, --gradient-bg
//

/*------------------------------------------------------------------
  # Base Card Block
-------------------------------------------------------------------*/

/**
 * Base card component (default: primary variant)
 */
.c-card {
  position: relative; // For badge positioning
  @include card-v4('primary', false);
  border-top: 4px solid var(--card-accent-primary); // v5.1: Brand color accent (emerald)

  // Variant modifiers (8 unified variants)
  &--primary {
    @include card-v4('primary', false);
  }

  &--secondary {
    @include card-v4('secondary', false);
    border-top-color: var(--card-accent-secondary); // v5.1: Terracotta accent
  }

  &--tertiary {
    @include card-v4('tertiary', false);
  }

  &--success {
    @include card-v4('success', false);
  }

  &--warning {
    @include card-v4('warning', false);
  }

  &--error {
    @include card-v4('error', false);
  }

  &--info {
    @include card-v4('info', false);
  }

  &--neutral {
    @include card-v4('neutral', false);
  }

  // Legacy variants (backward compatibility)
  &--coral {
    @include card-v4('coral', false);
  }

  &--sage {
    @include card-v4('sage', false);  // Alias for success
  }

  // State modifiers
  &--elevated {
    @include card-v4('primary', true);
  }
}

/*------------------------------------------------------------------
  # Card Style Variants (Block Modifiers)
-------------------------------------------------------------------*/

/**
 * Glassmorphism card variant
 */
.c-card--glass {
  @include card-glass('primary', 12px, 0.7);

  &.c-card--secondary {
    @include card-glass('secondary', 12px, 0.7);
  }

  &.c-card--neutral {
    @include card-glass('neutral', 12px, 0.7);
  }

  // Sub-modifier: stronger glass effect
  &.c-card--glass-strong {
    @include card-glass('primary', 20px, 0.8);
  }
}

/**
 * Gradient border card variant
 */
.c-card--gradient-border {
  @include card-gradient-border('primary');

  &.c-card--secondary {
    @include card-gradient-border('secondary');
  }

  &.c-card--healing {
    @include card-gradient-border('healing');
  }
}

/**
 * Top accent border card variant
 */
.c-card--top-accent {
  @include card-top-accent('primary');

  &.c-card--secondary {
    @include card-top-accent('secondary');
  }

  &.c-card--coral {
    @include card-top-accent('coral');
  }

  &.c-card--sage {
    @include card-top-accent('sage');
  }
}

/**
 * Hover lift animation card variant
 */
.c-card--hover-lift {
  @include card-v4('primary', false);
  @include card-hover-lift(-8px);

  // Sub-modifiers for lift intensity
  &.c-card--lift-small {
    @include card-hover-lift(-4px);
  }

  &.c-card--lift-large {
    @include card-hover-lift(-12px);
  }
}

/**
 * Gradient background card variant
 */
.c-card--gradient-bg {
  @include card-gradient-bg('primary-subtle');

  &.c-card--secondary {
    @include card-gradient-bg('secondary-subtle');
  }

  &.c-card--light {
    @include card-gradient-bg('light');
  }
}

/*------------------------------------------------------------------
  # Card Elements (BEM Structure)
-------------------------------------------------------------------*/

/**
 * Card header (title + icon)
 */
.c-card__header {
  display: flex;
  align-items: center;
  gap: var(--spacing-sm);
  margin-bottom: var(--spacing-md);
}

/**
 * Card icon element
 */
.c-card__icon {
  flex-shrink: 0;
}

/**
 * Card title element
 */
.c-card__title {
  font-family: var(--card-title-font-family);
  font-size: var(--card-title-font-size);
  font-weight: var(--card-title-font-weight);
  color: var(--card-title-color);
  margin: 0;
}

/**
 * Card body (main content)
 */
.c-card__body {
  color: var(--card-body-color);
  font-size: var(--card-body-font-size);
  line-height: var(--card-body-line-height);
  margin-bottom: var(--card-body-margin-bottom);

  p:last-child {
    margin-bottom: 0;
  }
}

/**
 * Card footer (actions, metadata)
 */
.c-card__footer {
  display: flex;
  align-items: center;
  justify-content: space-between;
  margin-top: var(--card-footer-margin-top);
  padding-top: var(--card-footer-padding-top);
  border-top: var(--card-footer-border-top);
}

/**
 * Card metadata element
 */
.c-card__meta {
  font-size: var(--card-meta-font-size);
  color: var(--card-meta-color);
}

/**
 * Card action link element
 */
.c-card__action {
  font-size: var(--card-action-font-size);
  font-weight: var(--card-action-font-weight);
  color: var(--card-action-color);
  text-decoration: none;
  transition: var(--card-action-transition);

  &:hover {
    color: var(--card-action-hover-color);
    text-decoration: underline;
  }
}

/*------------------------------------------------------------------
  # REDESIGN 2025 Card Variant
-------------------------------------------------------------------*/

/**
 * Redesign 2025 card variant
 * REDESIGN: Heavy rounded cards with cream borders and gold accent hover
 *
 * Design spec (eval1.md):
 * - Border-radius: 32px ($radius-2xl)
 * - Border: 1px solid cream (#E9EFEC / $cream-200)
 * - Background: White (#FFFFFF)
 * - Hover: Border changes to gold accent/30, shadow-2xl, lift -2px
 * - Icon blob integration (icon-blob atom scales on card hover)
 *
 * Usage: Add .c-card--redesign modifier to any card
 */
.c-card--redesign {
  border-radius: var(--card-border-radius-redesign);  // 32px heavy rounding
  border: var(--card-border-width) solid var(--card-redesign-border-light);  // Cream border (#E9EFEC)
  background: var(--card-bg);
  padding: var(--card-padding-redesign);  // 40px (matches design spec)
  transition: var(--card-transition);  // Slower shadow (1200ms)
  box-shadow: var(--card-shadow);  // Resting state shadow

  // Remove top accent border from v4.0 design
  border-top-width: var(--card-border-width);
  border-top-color: var(--card-redesign-border-light);

  // Hover state
  &:hover {
    border-color: var(--card-redesign-hover-border);  // Gold accent at 30% opacity
    box-shadow: var(--card-shadow-hover);  // Deeper shadow
    transform: translateY(var(--card-redesign-hover-lift));  // Slight lift
  }

  // Card title in redesign uses Playfair Display (serif)
  .c-card__title {
    font-family: var(--card-title-font-family);  // Playfair Display
    font-size: var(--card-title-font-size-redesign);  // 24px
    font-weight: var(--card-title-font-weight-redesign);  // 600
    color: var(--card-title-color-redesign);  // Dark green
    margin-bottom: var(--card-title-margin-bottom);  // 16px
  }

  // Card body text styling
  .c-card__body {
    font-family: var(--card-body-font-family);  // DM Sans
    font-size: var(--card-body-font-size);  // 16px
    line-height: var(--card-body-line-height-redesign);
    color: var(--card-body-color-redesign);  // Muted green-grey (#587065)
  }

  // Icon blob positioning and spacing
  .c-icon-blob {
    margin-bottom: var(--card-icon-blob-margin-bottom);  // 24px gap between icon and title
  }
}

/**
 * Card number badge element (Task 3.4)
 * Circular badge displayed in top-right corner
 */
.c-card__badge {
  // Position in top-right corner
  position: absolute;
  top: var(--card-badge-position-top);  // 32px from top
  right: var(--card-badge-position-right); // 32px from right
  z-index: 10;

  // Layout
  display: flex;
  align-items: center;
  justify-content: center;
  width: var(--card-badge-size);
  height: var(--card-badge-size);

  // Visual
  background: var(--card-badge-bg);
  color: var(--card-badge-color);
  font-family: var(--card-body-font-family);
  font-size: var(--card-badge-font-size); // 18px
  font-weight: var(--card-badge-font-weight); // 600
  border-radius: var(--card-badge-border-radius); // Circular
  box-shadow: var(--card-badge-shadow);

  // Responsive
  @media (max-width: $breakpoint-sm) {
    width: var(--card-badge-size-mobile);
    height: var(--card-badge-size-mobile);
    top: var(--card-badge-position-top-mobile);
    right: var(--card-badge-position-right-mobile);
    font-size: var(--card-badge-font-size-mobile); // 16px
  }
}

/*------------------------------------------------------------------
  # Card Hover Spotlight (Design Excellence)
-------------------------------------------------------------------*/

/**
 * DESIGN EXCELLENCE: Card hover spotlight effect
 * Principle: "Hovered card gets spotlight, neighbors dim (opacity: 0.85)"
 * Creates hierarchy through contrast - focused card stands out
 */
.c-card-grid:hover,
.c-card-grid--3col:hover,
.c-card-grid--4col:hover {
  // When grid is hovered, dim all cards
  .c-card {
    opacity: 0.75;
    transform: scale(0.98);
  }

  // But spotlight the hovered card
  .c-card:hover {
    opacity: 1;
    transform: translateY($hover-lift-md) scale(1);
    z-index: 2;
  }
}

// Card transition for smooth spotlight effect
.c-card {
  transition: opacity $duration-base $easing-medium,
              transform $duration-base $easing-medium,
              box-shadow $duration-slow $easing-medium;
}

// Disable spotlight on mobile (touch doesn't have hover semantics)
@media (max-width: $breakpoint-md - 1) {
  .c-card-grid:hover,
  .c-card-grid--3col:hover,
  .c-card-grid--4col:hover {
    .c-card {
      opacity: 1;
      transform: none;
    }
  }
}

/*------------------------------------------------------------------
  # Card Grid Layouts (Object-like, but card-specific)
-------------------------------------------------------------------*/

/**
 * 2-column card grid (default)
 */
.c-card-grid {
  display: grid;
  grid-template-columns: 1fr;
  gap: var(--card-grid-gap);

  @media (min-width: $breakpoint-md) {
    grid-template-columns: repeat(2, 1fr);
  }

  @media (min-width: $breakpoint-lg) {
    gap: var(--card-grid-gap-lg);
  }
}

/**
 * 3-column card grid
 */
.c-card-grid--3col {
  @extend .c-card-grid;

  @media (min-width: $breakpoint-lg) {
    grid-template-columns: repeat(3, 1fr);
  }
}

/**
 * 4-column card grid
 */
.c-card-grid--4col {
  @extend .c-card-grid;

  @media (min-width: $breakpoint-md) {
    grid-template-columns: repeat(2, 1fr);
  }

  @media (min-width: $breakpoint-lg) {
    grid-template-columns: repeat(4, 1fr);
  }
}

/**
 * Masonry card grid (Pinterest-style)
 */
.c-card-grid--masonry {
  display: grid;
  grid-template-columns: 1fr;
  gap: var(--card-grid-gap);

  @media (min-width: $breakpoint-md) {
    grid-template-columns: repeat(2, 1fr);
    grid-auto-rows: auto;
  }

  @media (min-width: $breakpoint-lg) {
    grid-template-columns: repeat(3, 1fr);
  }
}

/*------------------------------------------------------------------
  # Auto-Color Distribution (Context-Specific)
  # Applied when no explicit variant specified
-------------------------------------------------------------------*/

/**
 * Service cards - alternating primary/secondary
 */
.services-grid,
.related-services-section {
  .c-card:not([class*="c-card--"]) {
    &:nth-child(odd) {
      @include card-top-accent('primary');
    }
    &:nth-child(even) {
      @include card-top-accent('secondary');
    }
  }

  // Legacy class support (temporary)
  .service-card:not([class*="c-card--"]) {
    &:nth-child(odd) {
      @include card-top-accent('primary');
    }
    &:nth-child(even) {
      @include card-top-accent('secondary');
    }
  }
}

/**
 * Feature cards - 4-color rotation
 */
.features-grid,
.benefits-grid {
  .c-card:not([class*="c-card--"]) {
    &:nth-child(4n+1) {
      @include card-top-accent('primary');
    }
    &:nth-child(4n+2) {
      @include card-top-accent('secondary');
    }
    &:nth-child(4n+3) {
      @include card-top-accent('coral');
    }
    &:nth-child(4n+4) {
      @include card-top-accent('sage');
    }
  }

  // Legacy class support (temporary)
  .feature-card:not([class*="c-card--"]),
  .benefit-card:not([class*="c-card--"]) {
    &:nth-child(4n+1) {
      @include card-top-accent('primary');
    }
    &:nth-child(4n+2) {
      @include card-top-accent('secondary');
    }
    &:nth-child(4n+3) {
      @include card-top-accent('coral');
    }
    &:nth-child(4n+4) {
      @include card-top-accent('sage');
    }
  }
}

/**
 * Blog cards - alternating elevated/standard
 */
.blog-grid {
  .c-card:not([class*="c-card--"]) {
    &:nth-child(odd) {
      @include card-v4('primary', false);
    }
    &:nth-child(even) {
      @include card-v4('primary', true);
    }
  }

  // Legacy class support (temporary)
  .blog-card:not([class*="c-card--"]) {
    &:nth-child(odd) {
      @include card-v4('primary', false);
    }
    &:nth-child(even) {
      @include card-v4('primary', true);
    }
  }
}

/**
 * Testimonial cards - gradient backgrounds
 */
.testimonials-grid {
  .c-card:not([class*="c-card--"]) {
    &:nth-child(3n+1) {
      @include card-gradient-bg('primary-subtle');
    }
    &:nth-child(3n+2) {
      @include card-gradient-bg('secondary-subtle');
    }
    &:nth-child(3n+3) {
      @include card-gradient-bg('light');
    }
  }

  // Legacy class support (temporary)
  .testimonial-card:not([class*="c-card--"]) {
    &:nth-child(3n+1) {
      @include card-gradient-bg('primary-subtle');
    }
    &:nth-child(3n+2) {
      @include card-gradient-bg('secondary-subtle');
    }
    &:nth-child(3n+3) {
      @include card-gradient-bg('light');
    }
  }
}

/*------------------------------------------------------------------
  # Legacy Class Compatibility (Phase 3 Transition)
  # TODO: Remove in Phase 4 after HTML templates updated
-------------------------------------------------------------------*/

// Base compatibility
.card-v4 {
  @extend .c-card;
}

// Variant compatibility (8 unified variants)
.card-primary {
  @extend .c-card--primary;
}

.card-secondary {
  @extend .c-card--secondary;
}

.card-tertiary {
  @extend .c-card--tertiary;
}

.card-success {
  @extend .c-card--success;
}

.card-warning {
  @extend .c-card--warning;
}

.card-error {
  @extend .c-card--error;
}

.card-info {
  @extend .c-card--info;
}

.card-neutral {
  @extend .c-card--neutral;
}

// Legacy variant compatibility
.card-coral {
  @extend .c-card--coral;
}

.card-sage {
  @extend .c-card--sage;
}

.card-elevated {
  @extend .c-card--elevated;
}

// Style variant compatibility
.card-glass {
  @extend .c-card--glass;
}

.card-gradient-border {
  @extend .c-card--gradient-border;
}

.card-top-accent {
  @extend .c-card--top-accent;
}

.card-hover-lift {
  @extend .c-card--hover-lift;
}

.card-gradient-bg {
  @extend .c-card--gradient-bg;
}

// Element compatibility
.card-header {
  @extend .c-card__header;
}

.card-icon {
  @extend .c-card__icon;
}

.card-title {
  @extend .c-card__title;
}

.card-body {
  @extend .c-card__body;
}

.card-footer {
  @extend .c-card__footer;
}

.card-meta {
  @extend .c-card__meta;
}

.card-action {
  @extend .c-card__action;
}

// Grid compatibility
.card-grid {
  @extend .c-card-grid;
}

.card-grid-3 {
  @extend .c-card-grid--3col;
}

.card-grid-4 {
  @extend .c-card-grid--4col;
}

.card-grid-masonry {
  @extend .c-card-grid--masonry;
}

// ==================================
// USAGE GUIDE
// ==================================
//
// Basic card:
//   <div class="c-card">...</div>
//
// Card with variant:
//   <div class="c-card c-card--secondary">...</div>
//
// Card with style variant:
//   <div class="c-card c-card--glass c-card--secondary">...</div>
//
// Card structure:
//   <div class="c-card c-card--primary">
//     <div class="c-card__header">
//       <div class="c-card__icon">...</div>
//       <h3 class="c-card__title">Title</h3>
//     </div>
//     <div class="c-card__body">
//       <p>Content...</p>
//     </div>
//     <div class="c-card__footer">
//       <span class="c-card__meta">Metadata</span>
//       <a href="#" class="c-card__action">Action Link</a>
//     </div>
//   </div>
//
// Card grid:
//   <div class="c-card-grid c-card-grid--3col">
//     <div class="c-card">...</div>
//     <div class="c-card">...</div>
//     <div class="c-card">...</div>
//   </div>
//
// VERSION HISTORY:
// 3.0.0 (2025-11-19) - ITCSS Phase 3: Full BEM refactoring with legacy compatibility
// 2.0.0 (2025-11-19) - ITCSS Phase 2: Mixins extracted to tools layer
// 1.0.0 (2025-11-17) - Initial card system with v4.0 enhancements
//
