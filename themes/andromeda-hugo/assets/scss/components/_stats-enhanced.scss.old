/*
========================================================================
  Stats Numbers Enhanced - Animated counters with SVG progress rings
  Creative warm design with circular indicators
========================================================================
*/

.stats-numbers {
  padding: $space-16 0;
  position: relative;
  overflow: hidden;
  background: $gradient-warm-subtle;

  // Organic background
  &::before {
    content: '';
    position: absolute;
    bottom: -10%;
    right: -8%;
    width: 45%;
    height: 120%;
    background: $gradient-radial-secondary;
    opacity: 0.08;
    @include organic-blob('smooth');
    z-index: 0;
  }

  .container-xxl {
    position: relative;
    z-index: 1;
  }
}

// Stat Item Container
.stat-item {
  position: relative;
  padding: $space-6;
  background: $gradient-glass-light;
  @include glassmorphism(12px, 0.9);
  border-radius: $radius-xl;
  box-shadow: $shadow-base;
  transition: all $duration-base $easing-medium; // Level 2 card motion
  @include staggered-entrance(fade-in-up, 150ms);

  &:hover {
    transform: translateY(-8px);
    box-shadow: $shadow-warm-lg;
    background: rgba(255, 255, 255, 0.95);

    .stat-progress-ring {
      transform: scale(1.05);
    }
  }
}

// SVG Progress Ring Container
.stat-progress-ring {
  position: relative;
  width: 120px;
  height: 120px;
  margin: 0 auto $space-5;
  transition: transform $duration-base $easing-medium; // Level 2 motion

  svg {
    width: 100%;
    height: 100%;
    transform: rotate(-90deg);
    filter: drop-shadow(0 4px 8px rgba(0, 0, 0, 0.1));
  }

  // Background circle
  .ring-background {
    fill: none;
    stroke: $gray-200;
    stroke-width: 8;
  }

  // Progress circle (animated)
  .ring-progress {
    fill: none;
    stroke-width: 8;
    stroke-linecap: round;
    transition: stroke-dashoffset $duration-slow $ease-out;

    // Default gradient (will be overridden by variants)
    stroke: url(#gradient-primary);
  }

  // Inner content (number + label)
  .stat-inner-content {
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    text-align: center;
    width: 100%;
  }
}

// Stat Number (inside ring)
.stat-number {
  font-size: $text-4xl;
  font-weight: $weight-bold;
  line-height: 1;
  color: $color-primary;
  font-family: $font-display;
  margin-bottom: $space-2;

  // Animated counter
  .stat-count {
    display: inline-block;
    transition: transform $duration-fast $ease-out;
  }

  .stat-suffix {
    font-size: $text-2xl;
    opacity: 0.8;
  }

  // Pulse effect when counting
  &.counting .stat-count {
    animation: pulse-number $duration-fast ease-in-out;
  }
}

// Stat Label
.stat-label {
  font-size: $text-base;
  font-weight: $weight-medium;
  color: $color-text-secondary;
  margin-top: $space-3;
  line-height: $leading-snug;
}

// Icon (optional, if ring is not used)
.stat-icon {
  width: $icon-circle-lg;
  height: $icon-circle-lg;
  margin: 0 auto $space-4;
  border-radius: $radius-full;
  display: flex;
  align-items: center;
  justify-content: center;
  background: $gradient-icon-emerald;
  box-shadow: $shadow-base;
  transition: transform $duration-normal $ease-out;

  i, .icon {
    font-size: $icon-circle-sm;  // 32px - Design token (Week 3)
    color: white;
  }

  .stat-item:hover & {
    transform: rotate(8deg) scale(1.1);
  }
}

// Color Variants (for progress rings)
.stat-item-variant-1 .ring-progress {
  stroke: url(#gradient-emerald);
}

.stat-item-variant-2 .ring-progress {
  stroke: url(#gradient-terracotta);
}

.stat-item-variant-3 .ring-progress {
  stroke: url(#gradient-teal);
}

.stat-item-variant-4 .ring-progress {
  stroke: url(#gradient-amber);
}

// Animations
@keyframes pulse-number {
  0%, 100% {
    transform: scale(1);
  }
  50% {
    transform: scale(1.1);
  }
}

@keyframes ring-fill {
  from {
    stroke-dashoffset: 283; // Circumference of 90px radius circle
  }
  to {
    stroke-dashoffset: 0;
  }
}

// SVG Gradients Definitions (inline in HTML or here)
.stat-svg-defs {
  position: absolute;
  width: 0;
  height: 0;
  overflow: hidden;
}

// Responsive Design
@media (max-width: $breakpoint-lg) {
  .stat-progress-ring {
    width: 100px;
    height: 100px;
  }

  .stat-number {
    font-size: $text-3xl;

    .stat-suffix {
      font-size: $text-xl;
    }
  }
}

@media (max-width: $breakpoint-md) {
  .stats-numbers {
    padding: $space-12 0;
  }

  .stat-item {
    margin-bottom: $space-6;
  }

  .stat-progress-ring {
    width: 90px;
    height: 90px;
  }

  .stat-number {
    font-size: $text-2xl;

    .stat-suffix {
      font-size: $text-lg;
    }
  }

  .stat-label {
    font-size: $text-sm;
  }
}

@media (max-width: $breakpoint-sm) {
  .stat-item {
    padding: $space-5;
  }
}

// Accessibility
@media (prefers-reduced-motion: reduce) {
  .stat-item,
  .stat-progress-ring,
  .stat-number,
  .ring-progress {
    animation: none !important;
    transition-duration: 0.01ms !important;
  }
}

// High Contrast Mode
@media (prefers-contrast: high) {
  .stat-item {
    border: 2px solid currentColor;
    background: $color-bg-primary !important;
  }

  .ring-progress,
  .ring-background {
    stroke: currentColor !important;
  }
}
