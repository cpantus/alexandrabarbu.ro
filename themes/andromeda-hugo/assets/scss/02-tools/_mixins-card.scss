// ==================================
// CARD MIXINS - v4.0 Card Enhancement Mixins
// ==================================
//
// Purpose: Transform flat legacy cards into v4.0 elevated cards
// Features: Glassmorphism, gradient borders, colored shadows, hover effects
//
// Last Updated: 2025-11-19 (Phase 2 - System Layer Refactoring)
// Version: 2.0.0 (ITCSS Architecture - Mixins Only, NO CSS Output)
//

/**
 * Base v4.0 Card with Gradient Glow (elegant soft border)
 * Modern card with glassmorphism gradient glow effect (unified theme-wide)
 * @param {string} $variant - Color variant for glow (primary, secondary, coral, sage)
 * @param {boolean} $elevated - Whether to apply elevated shadow (default: false)
 */
@mixin card-v4($variant: 'primary', $elevated: false) {
  position: relative;
  background: $gradient-glass-light;
  @include glassmorphism($card-border-radius, 0.9);
  border: none !important;  // Remove glassmorphism border - gradient glow only
  border-radius: $card-border-radius; // 12px (design token rule)
  padding: $card-padding; // 16px (molecule tier)
  transition: transform 400ms $easing-medium,
              box-shadow 1200ms $easing-medium,
              background 400ms $easing-medium; // Slower shadow transition (1200ms)

  // Base shadow
  @if $elevated {
    box-shadow: $card-shadow-hover; // Elevated rest state
  } @else {
    box-shadow: $card-shadow; // Subtle rest state
  }

  // Hover effect: gradient glow appears + lift
  &:hover {
    transform: translateY(-2px) scale(1.02);
    background: rgba(255, 255, 255, 0.95);

    // Variant-specific gradient glow (soft, elegant) - 8 unified variants
    @if $variant == 'primary' {
      box-shadow:
        0 0 0 1px rgba($emerald-400, 0.2),
        0 8px 24px -4px rgba($emerald-500, 0.25),
        0 16px 48px -8px rgba($emerald-400, 0.15);
    } @else if $variant == 'secondary' {
      box-shadow:
        0 0 0 1px rgba($terracotta-400, 0.2),
        0 8px 24px -4px rgba($terracotta-500, 0.25),
        0 16px 48px -8px rgba($terracotta-400, 0.15);
    } @else if $variant == 'tertiary' {
      box-shadow:
        0 0 0 1px rgba($navy-400, 0.2),
        0 8px 24px -4px rgba($navy-500, 0.25),
        0 16px 48px -8px rgba($navy-400, 0.15);
    } @else if $variant == 'success' or $variant == 'sage' {
      // success = sage (backward compatibility)
      box-shadow:
        0 0 0 1px rgba($sage-400, 0.2),
        0 8px 24px -4px rgba($sage-500, 0.25),
        0 16px 48px -8px rgba($sage-400, 0.15);
    } @else if $variant == 'warning' {
      box-shadow:
        0 0 0 1px rgba($amber-400, 0.2),
        0 8px 24px -4px rgba($amber-500, 0.25),
        0 16px 48px -8px rgba($amber-400, 0.15);
    } @else if $variant == 'error' {
      box-shadow:
        0 0 0 1px rgba($red-400, 0.2),
        0 8px 24px -4px rgba($red-500, 0.25),
        0 16px 48px -8px rgba($red-400, 0.15);
    } @else if $variant == 'info' {
      box-shadow:
        0 0 0 1px rgba($teal-400, 0.2),
        0 8px 24px -4px rgba($teal-500, 0.25),
        0 16px 48px -8px rgba($teal-400, 0.15);
    } @else if $variant == 'neutral' {
      box-shadow:
        0 0 0 1px rgba($gray-400, 0.2),
        0 8px 24px -4px rgba($gray-500, 0.25),
        0 16px 48px -8px rgba($gray-400, 0.15);
    } @else if $variant == 'coral' {
      // coral kept for specific use cases (testimonials, warm content)
      box-shadow:
        0 0 0 1px rgba($coral-400, 0.2),
        0 8px 24px -4px rgba($coral-500, 0.25),
        0 16px 48px -8px rgba($coral-400, 0.15);
    } @else {
      box-shadow: $shadow-md; // Fallback
    }
  }
}

/**
 * Card with Glassmorphism
 * Frosted glass card effect with backdrop blur
 * @param {string} $variant - Color variant for tint
 * @param {number} $blur - Backdrop blur amount (default: 12px)
 * @param {number} $opacity - Background opacity (default: 0.7)
 */
@mixin card-glass($variant: 'primary', $blur: 12px, $opacity: 0.7) {
  position: relative;
  backdrop-filter: blur($blur);
  -webkit-backdrop-filter: blur($blur);
  border-radius: $card-border-radius;
  padding: $card-padding;
  transition: $card-transition;

  // Semi-transparent background with tint
  @if $variant == 'primary' {
    background: rgba(#ffffff, $opacity);
    border: 1px solid rgba($emerald-500, 0.2);
  } @else if $variant == 'secondary' {
    background: rgba(#ffffff, $opacity);
    border: 1px solid rgba($terracotta-500, 0.2);
  } @else if $variant == 'neutral' {
    background: rgba(#ffffff, $opacity);
    border: 1px solid rgba($gray-300, 0.3);
  }

  // Subtle shadow
  box-shadow: 0 8px 32px 0 rgba(0, 0, 0, 0.1);

  // Hover: stronger blur + lift
  &:hover {
    backdrop-filter: blur($blur + 4px);
    -webkit-backdrop-filter: blur($blur + 4px);
    transform: translateY(-4px);
    box-shadow: 0 12px 40px 0 rgba(0, 0, 0, 0.15);
  }
}

/**
 * Card with Gradient Border
 * Animated gradient border effect (v4.0 premium style)
 * @param {string} $gradient - Gradient type (primary, secondary, healing)
 */
@mixin card-gradient-border($gradient: 'primary') {
  position: relative;
  background: #ffffff;
  border-radius: $card-border-radius;
  padding: $card-padding;
  transition: $card-transition;

  // Gradient border via pseudo-element
  &::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    border-radius: $card-border-radius;
    padding: 2px; // Border width
    z-index: -1;

    @if $gradient == 'primary' {
      background: linear-gradient(135deg, $emerald-400 0%, $emerald-500 100%);
    } @else if $gradient == 'secondary' {
      background: linear-gradient(135deg, $terracotta-400 0%, $terracotta-500 100%);
    } @else if $gradient == 'healing' {
      background: linear-gradient(135deg, $emerald-400 0%, $terracotta-400 100%);
    }

    // Mask to create border effect
    -webkit-mask:
      linear-gradient(#fff 0 0) content-box,
      linear-gradient(#fff 0 0);
    -webkit-mask-composite: xor;
    mask-composite: exclude;
  }

  // Hover: brighter gradient + lift
  &:hover {
    transform: translateY(-4px);
    box-shadow: $shadow-md;

    &::before {
      @if $gradient == 'primary' {
        background: linear-gradient(135deg, $emerald-300 0%, $emerald-600 100%);
      } @else if $gradient == 'secondary' {
        background: linear-gradient(135deg, $terracotta-300 0%, $terracotta-600 100%);
      } @else if $gradient == 'healing' {
        background: linear-gradient(135deg, $emerald-300 0%, $terracotta-300 100%);
      }
    }
  }
}

/**
 * Card with Top Border Accent
 * Colored top border (3px) with matching icon/shadow
 * @param {string} $variant - Color variant (primary, secondary, coral, sage)
 */
@mixin card-top-accent($variant: 'primary') {
  @include card-v4($variant, false);

  // Thick top border
  border-top: 3px solid;
  @if $variant == 'primary' {
    border-top-color: $emerald-500;
  } @else if $variant == 'secondary' {
    border-top-color: $terracotta-500;
  } @else if $variant == 'coral' {
    border-top-color: $coral-500;
  } @else if $variant == 'sage' {
    border-top-color: $sage-500;
  }

  // Icon color matches border
  .card-icon,
  .icon-circle {
    @if $variant == 'primary' {
      background: linear-gradient(135deg, $emerald-400 0%, $emerald-500 100%);
    } @else if $variant == 'secondary' {
      background: linear-gradient(135deg, $terracotta-400 0%, $terracotta-500 100%);
    } @else if $variant == 'coral' {
      background: linear-gradient(135deg, $coral-400 0%, $coral-500 100%);
    } @else if $variant == 'sage' {
      background: linear-gradient(135deg, $sage-400 0%, $sage-500 100%);
    }
  }
}

/**
 * Card with Hover Lift Animation
 * Pronounced lift effect with shadow growth
 * @param {number} $lift - Lift distance in pixels (default: -8px)
 */
@mixin card-hover-lift($lift: -8px) {
  transition: transform $duration-fast $ease-out,
              box-shadow $duration-fast $ease-out;

  &:hover {
    transform: translateY($lift);
    box-shadow: $shadow-lg;
  }
}

/**
 * Card with Gradient Background
 * Full card background gradient (subtle, not overwhelming)
 * @param {string} $variant - Gradient variant (primary-subtle, secondary-subtle, light)
 */
@mixin card-gradient-bg($variant: 'primary-subtle') {
  border-radius: $card-border-radius;
  padding: $card-padding;
  transition: $card-transition;
  border: 1px solid rgba(#ffffff, 0.3);

  @if $variant == 'primary-subtle' {
    background: linear-gradient(135deg, $emerald-50 0%, #ffffff 100%);
  } @else if $variant == 'secondary-subtle' {
    background: linear-gradient(135deg, $terracotta-50 0%, #ffffff 100%);
  } @else if $variant == 'light' {
    background: linear-gradient(135deg, $gray-50 0%, #ffffff 100%);
  }

  box-shadow: $card-shadow;

  &:hover {
    box-shadow: $card-shadow-hover;
    transform: translateY(-4px);
  }
}

// ==================================
// USAGE RULES
// ==================================
// 1. Mixins provide styling logic, NO CSS output here
// 2. Component classes use these mixins in 06-components/_card.scss (Phase 3)
// 3. Always pass $variant parameter for semantic meaning
// 4. Use $card-border-radius, $card-padding tokens (from 01-settings/)
// 5. Card transitions follow Level 2 motion (300ms, ease-in-out)
//
// VERSION HISTORY:
// 2.0.0 (2025-11-19) - ITCSS Phase 2: Extracted from systems/_card-system.scss
// 1.0.0 (2025-11-17) - Initial card system with v4.0 enhancements
//
