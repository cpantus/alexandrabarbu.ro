{{/*
  Header Organism - CMS-Managed Version

  Project-level override that adds support for CMS data file (data/settings.yaml)
  Fallback chain: site.Data.settings.nav_button > site.Params.navigation_button

  Version: 5.1.0 (CMS-Managed)
  Last Updated: 2025-12-01
*/}}

{{- $currentLang := site.Language.Lang -}}

{{/* Resolve nav_button from CMS data or params.toml */}}
{{- $navButton := site.Data.settings.nav_button | default site.Params.navigation_button | default dict -}}

<!-- Skip to Content Link (WCAG 2.1 AA - Keyboard Navigation) -->
<a href="#main-content" class="c-header__skip-link visually-hidden-focusable">
  {{- if eq $currentLang "ro" -}}
    Sari la conținut
  {{- else -}}
    Skip to main content
  {{- end -}}
</a>

<!-- Header Height Spacer (prevents content jump when header is fixed) -->
<div class="c-header__spacer"></div>

<!-- Main Header -->
<header class="c-header">
  <div class="c-header__container">
    <div class="c-header__inner">

      {{/* Logo Brand Link */}}
      <a class="c-header__brand" href="{{ site.BaseURL | relLangURL }}" aria-label="{{ if eq $currentLang "ro" }}Pagina principală{{ else }}Home page{{ end }}">
        {{ partial "molecules/logo.html" (dict "color" "primary" "size" "sm" "link" false "context" .) }}
      </a>

      {{/* Navigation Controller (Mobile: Language Selector + Hamburger) */}}
      <div class="c-header__nav-controller">

        {{/* Mobile Language Selector */}}
        <div class="c-header__lang-mobile">
          {{ partial "molecules/language-selector.html" (dict "variant" "mobile" "context" .) }}
        </div>

        {{/* Mobile Menu Toggle Button */}}
        <button
          class="c-header__toggle"
          type="button"
          data-toggle="collapse"
          data-target="#headerNav"
          aria-controls="headerNav"
          aria-expanded="false"
          aria-label="{{ if eq $currentLang "ro" }}Comută navigarea{{ else }}Toggle navigation{{ end }}">
          {{/* Menu Icon (shown when menu closed) */}}
          <span class="c-header__toggle-icon c-header__toggle-icon--open">
            {{ partial "atoms/icon.html" (dict "icon" "bars" "size" "lg" "variant" "primary") }}
          </span>
          {{/* Close Icon (shown when menu open) */}}
          <span class="c-header__toggle-icon c-header__toggle-icon--close">
            {{ partial "atoms/icon.html" (dict "icon" "times" "size" "lg" "variant" "primary") }}
          </span>
        </button>
      </div>

      {{/* Collapsible Navigation Container */}}
      <div class="c-header__collapse" id="headerNav">

        {{/* Primary Navigation */}}
        <nav class="c-header__nav" aria-label="{{ if eq $currentLang "ro" }}Navigare principală{{ else }}Primary navigation{{ end }}">
          {{ partial "molecules/navigation.html" . }}
        </nav>

        {{/* Actions (Desktop Language Selector + Optional CTA) */}}
        <div class="c-header__actions">

          {{/* Desktop Language Selector */}}
          <div class="c-header__lang-desktop">
            {{ partial "molecules/language-selector.html" (dict "variant" "desktop" "context" .) }}
          </div>

          {{/* Optional CTA Button - from CMS data or params.toml */}}
          {{ if $navButton.enable }}
            <div class="c-header__cta">
              {{ partial "atoms/button.html" (dict
                "text" ($navButton.text | default $navButton.label)
                "href" ($navButton.url | default $navButton.link)
                "variant" "primary"
                "size" "md"
              ) }}
            </div>
          {{ end }}
        </div>
      </div>

    </div>
  </div>
</header>
<!-- /Main Header -->
